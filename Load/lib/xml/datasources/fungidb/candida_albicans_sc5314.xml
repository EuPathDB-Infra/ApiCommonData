<!-- Saccharomyces cerevisiae (S288C) Resources -->
<resources>

  <!-- ISF FASTA resource -->
  <resource
        resource="candida_albicans_sc5314_genomic_sequence_RSRC"
        version="@@candida_albicans_sc5314_VER@@"
        plugin="GUS::Supported::Plugin::LoadFastaSequences">
        <manualGet 
              fileOrDir="FungiDB/candida_albicans_sc5314/genome/%RESOURCE_VERSION%/candida_albicans_sc5314.gff3"/>
        <!-- Unnecessary 
        <unpack>
              mkdir @@dataDir@@/fasta
        </unpack>
        -->
        <!-- Arg isn't input_file_or_dir but only input_dir (which can also be a file) -->

        <!-- Standardize scaffold IDs by prefixing -->
        <unpack>
               fungidb_uniquify_and_standardize_seqids.pl
                   --input  @@dataDir@@/candida_albicans_sc5314.gff3
                   --output @@dataDir@@/candida_albicans_sc5314.uniquified.gff3
                   --prefix Scer_s288c
        </unpack>

        <!-- Split FASTA from GFF -->
        <unpack>
             makeCustomFastaAndGffFromGff3
                  --input_dir @@dataDir@@/candida_albicans_sc5314.uniquified.gff3
                  --inputFileExt gff3
                  --output_fasta @@dataDir@@/candida_albicans_sc5314.unpacked.fasta
                  --output_gff   @@dataDir@@/candida_albicans_sc5314.unpacked.gff3
        </unpack>

        <!-- There may not be a taxonomy ID for some organisms; Others don't seem to be present in the taxonomy -->
        <pluginArgs>
             --externalDatabaseName %RESOURCE_NAME%
             --ncbiTaxId 559292
             --externalDatabaseVersion %RESOURCE_VERSION%
             --sequenceFile @@dataDir@@/candida_albicans_sc5314.unpacked.fasta
             --SOTermName 'chromosome' 
             --regexSourceId  '>(\S+)'
             --tableName "DoTS::ExternalNASequence"
             --regexChromosome '\d+\.(\d+)'
         </pluginArgs>

         <info
             displayName="Candida albicans (SC5314) genomic sequence"
             project="FungiDB"
             organisms="@@candida_albicans_sc5314_OrganismFullName@@"
             category="Genome"
             publicUrl=""
             contact=""
             email=""
             institution="CGD">
             <description>
                 <![CDATA[
                    Candida albicans (SC5314) genomic sequence. Source: CGD.
             ]]>
             </description>
         </info>
  </resource>


  <!-- ISF genomic annotations resource -->
  <resource
         resource="candida_albicans_sc5314_genomic_annotations_RSRC"
         version="@@candida_albicans_sc5314_VER@@" 
         parentResource="candida_albicans_sc5314_genomic_sequence_RSRC"
         plugin="GUS::Supported::Plugin::InsertSequenceFeatures">

         <manualGet fileOrDir="FungiDB/candida_albicans_sc5314/genome/%RESOURCE_VERSION%/candida_albicans_sc5314.unpacked.gff3" />

         <!-- Assume that S. cerevisiae transcript IDs are already unique -->


         <!-- Run the standard ISF preprocess step -->
         <unpack>
               preprocessGFF3 
                   --input_gff  @@dataDir@@/candida_albicans_sc5314.unpacked.gff3
                   --output_gff @@dataDir@@/candida_albicans_sc5314.transformed.gff3
         </unpack>

         <pluginArgs>
                --extDbName      %PARENT_RESOURCE_NAME%
                --extDbRlsVer    %PARENT_RESOURCE_VERSION%
                --mapFile        @@gusHome@@/lib/xml/isf/FungiDB/sgdGFF32Gus.xml
                --inputFileOrDir @@dataDir@@/candida_albicans_sc5314.transformed.gff3
                --inputFileExtension "gff3"
                --fileFormat     gff3
                --soCvsVersion   @@SO_VER@@
                --defaultOrganism "Saccharomyces cerevisiae S288C"
                --seqSoTerm "chromosome"
                --validationLog     @@dataDir@@/validation.log
                --bioperlTreeOutput @@dataDir@@/bioperlTree.out
                --seqIdColumn source_id
                --naSequenceSubclass ExternalNASequence
          </pluginArgs>

          <info
             displayName="Candida albicans (SC5314) genomic annotations"
             project="FungiDB"
             organisms="@@candida_albicans_sc5314_OrganismFullName@@"
             category="Genome"
             publicUrl=""
             contact=""
             email=""
             institution="Candida Genome Database">
             <description>
               <![CDATA[
                    Candida albicans (SC5314) genomic annations. Source: Candida Genome Database.
                ]]>
            </description>
          </info>
     </resource>


  <!-- GO associations -->
  <resource 
         resource="candida_albicans_sc5314_go_associations_RSRC"
         version="@@candida_albicans_sc5314_VER@@"
         plugin="ApiCommonData::Load::Plugin::InsertGOAssociationsSimple">

         <wgetArgs url="ftp://ftp.sanger.ac.uk/pub/pathogens/Plasmodium/falciparum/3D7/data.exchange">
               --tries=5 
               --mirror 
               -r
               --no-parent
               --no-host-directories
               --cut-dirs=5
          </wgetArgs>

         <manualGet 
              fileOrDir="FungiDB/candida_albicans_sc5314/gene_ontology/@@candida_albicans_sc5314_VER@@/gene_association.sgd" />
 
         <pluginArgs>
               --externalDatabaseSpec "%RESOURCE_NAME%|%RESOURCE_VERSION%"
               --inputFile @@dataDir@@/gene_association.sgd
               --goExternalDatabaseSpec "GO_RSRC|@@GO_VER@@"
               --seqIdSql "SELECT g.source_id, taf.aa_sequence_id FROM dots.genefeature g, dots.transcript t, dots.translatedAAFeature taf WHERE g.na_feature_id = t.parent_id AND t.na_feature_id = taf.na_feature_id UNION SELECT taf.source_id, taf.aa_sequence_id FROM dots.translatedAAFeature taf"
              --targetTable "DoTS::TranslatedAASequence"
              --lineOfEvidence "SGD"
              --inputIdColumn id
              --tolerateMissingSeqs
              --skipBadGOTerms @@dataDir@@/badGOTerms.log
         </pluginArgs>

         <info
              displayName="Candida albicans (SC5314) GO associations"
              project="FungiDB"
              organisms="@@candida_albicans_sc5314_OrganismFullName@@"
              category="Proteome"
              publicUrl=""
              contact=""
              email=""
              institution="Candida Genome Database">
              <description>
                 <![CDATA[
                     Candida albicans (SC5314) GO associations. Source: Candida Genome Database.
                 ]]>
              </description>
          </info>
   </resource>

   
   <!-- EC numbers -->
   <resource
          resource="candida_albicans_sc5314_ec_ids_RSRC" version="@@candida_albicans_sc5314_VER@@"
      plugin="GUS::Community::Plugin::InsertECMapping">
    <manualGet fileOrDir="FungiDB/candida_albicans_sc5314/IDs/%RESOURCE_VERSION%" />
    <unpack>
          fungidb_unpack_sgd_ids.pl
              --input @@dataDir@@/dbxref.tab
              --output @@dataDir@@/ec_numbers.tab
              --db IUBMB
              --type "EC number"
    </unpack>

    <pluginArgs>
          --ECMappingFile @@dataDir@@/ec_numbers.tab
          --evidenceCode "SGD"
          --aaSeqLocusTagMappingSql "SELECT aa_sequence_id FROM dots.GeneFeature g, dots.Transcript t, dots.TranslatedAAFeature taf WHERE g.source_id = ? AND g.na_feature_id = t.parent_id AND t.na_feature_id = taf.na_feature_id"
    </pluginArgs>
    
    <info
        displayName="Candida albicans (SC5314) EC IDs"
        project="FungiDB"
        organisms="@@candida_albicans_sc5314_OrganismFullName@@"
        category="Proteome"
        publicUrl=""
        contact=""
        email=""
        institution="Candida Genome Database">
      <description>
        <![CDATA[
         Candida albicans (SC5314) EC IDs. Source: Candida Genome Database.         
        ]]>
      </description>
    </info>
  </resource>

</resources>
