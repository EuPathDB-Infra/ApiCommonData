<!-- Candida albicans (SC5314) Resources -->
<resources>

  <!-- ISF FASTA resource -->
  <resource
        resource="candida_albicans_sc5314_genome_sequence_RSRC"
        version="@@candida_albicans_sc5314_GENOME_SEQUENCE_VER@@"
        plugin="GUS::Supported::Plugin::LoadFastaSequences">


         <!-- Fetching / preprocessing occurs upstream of the workflow. I think that's cleaner. -->
         <manualGet fileOrDir="FungiDB/candida_albicans_sc5314/genome/%RESOURCE_VERSION%/candida_albicans_sc5314.unpacked.fasta" />



         <!-- Or processing as part of workflow...
         <!-- WARNING! Versioned URL. Will need to be updated manually. -->
         <!-- 
                <manualGet fileOrDir="FungiDB/candida_albicans_sc5314/genome/%RESOURCE_VERSION%/C_albicans_SC5314_A21_features_with_chromosome_sequences.gff.gz" />
                <unpack>mv @@dataDir@@/C_albicans_SC5314_A21_features_with_chromosome_sequences.gff.gz @@dataDir@@/candida_albicans_sc5314.gff3.gz</unpack>
                <unpack>gunzip @@dataDir@@/candida_albicans_sc5314.gff3.gz</unpack>

                <unpack>
                    fungidb_uniquify_and_standardize_seqids.pl
                       --input  @@dataDir@@/candida_albicans_sc5314.gff3
                       --output @@dataDir@@/candida_albicans_sc5314.uniquified.gff3
                       --prefix @@candida_albicans_sc5314_FUNGIDB_ABBREVIATION@@
                       --ignore_contigs
                       --mapping_file @@dataDir@@/primary_gene_aliases.tab
               </unpack>

               <unpack>
                    makeCustomFastaAndGffFromGff3
                        --input_dir @@dataDir@@/candida_albicans_sc5314.gff3
                        --inputFileExt gff3
                        --output_fasta @@dataDir@@/candida_albicans_sc5314.unpacked.fasta
                        --output_gff   @@dataDir@@/candida_albicans_sc5314.unpacked.gff3
               </unpack>
               -->

        <!-- Sequence IDs: Ca21chr1_C_albicans_SC5314" -->
        <pluginArgs>
             --externalDatabaseName %RESOURCE_NAME%
             --ncbiTaxId @@candida_albicans_sc5314_NCBI_TAXONOMY_ID@@
             --externalDatabaseVersion %RESOURCE_VERSION%
             --sequenceFile      @@dataDir@@/candida_albicans_sc5314.unpacked.fasta
             --SOTermName        'chromosome' 
             --regexSourceId     '>(\S+)'
             --tableName         "DoTS::ExternalNASequence"
             --regexChromosome   'Ca\d\dchr(\d+)_.*'
         </pluginArgs>

         <info
             displayName="Candida albicans (SC5314) genomic sequence"
             project="FungiDB"
             organisms="@@candida_albicans_sc5314_FUNGIDB_DISPLAY_NAME@@"
             category="Genome"
             publicUrl="http://candidagenome.org/download/gff/candida_21_with_chromosome_sequences.gff.gz"
             contact="CGD Curator"
             email="candida-curator@genome.stanford.edu"
             institution="Candida Genome Database">
             <description>
                 <![CDATA[
                    Candida albicans (SC5314) genomic sequence. Source: CGD.
             ]]>
             </description>
         </info>
  </resource>


  <!-- ISF genomic annotations resource -->
  <resource
         resource="candida_albicans_sc5314_genome_annotations_RSRC"
         version="@@candida_albicans_sc5314_GENOME_SEQUENCE_VER@@" 
         parentResource="candida_albicans_sc5314_genome_sequence_RSRC"
         plugin="GUS::Supported::Plugin::InsertSequenceFeatures">

         <!-- Fetching / preprocessing occurs upstream of the workflow. I think that's cleaner. -->
        <manualGet fileOrDir="FungiDB/candida_albicans_sc5314/genome/%RESOURCE_VERSION%/candida_albicans_sc5314.transformed.gff3" />

        <!-- WARNING! Versioned URL. Will need to be updated manually. -->
        <!-- Or processing as part of workflow...
             <manualGet fileOrDir="FungiDB/candida_albicans_sc5314/genome/%RESOURCE_VERSION%/C_albicans_SC5314_A21_features_with_chromosome_sequences.gff.gz" />
             <unpack>mv @@dataDir@@/C_albicans_SC5314_A21_features_with_chromosome_sequences.gff.gz @@dataDir@@/candida_albicans_sc5314.gff3.gz</unpack>
             <unpack>gunzip @@dataDir@@/candida_albicans_sc5314.gff3.gz</unpack>

             <unpack>
                    fungidb_uniquify_and_standardize_seqids.pl
                        --input  @@dataDir@@/candida_albicans_sc5314.gff3
                        --output @@dataDir@@/candida_albicans_sc5314.uniquified.gff3
                        --prefix @@candida_albicans_sc5314_FUNGIDB_ABBREVIATION@@
                        --ignore_contigs
                        --mapping_file @@dataDir@@/primary_gene_aliases.tab
             </unpack>

             <unpack>
                  makeCustomFastaAndGffFromGff3
                       --input_dir @@dataDir@@/candida_albicans_sc5314.uniquified.gff3
                       --inputFileExt gff3
                       --output_fasta @@dataDir@@/candida_albicans_sc5314.unpacked.fasta
                       --output_gff   @@dataDir@@/candida_albicans_sc5314.unpacked.gff3
             </unpack>

             <unpack>
                    preprocessGFF3 
                        --input_gff  @@dataDir@@/candida_albicans_sc5314.unpacked.gff3
                        --output_gff @@dataDir@@/candida_albicans_sc5314.transformed.gff3
              </unpack>
             -->

         <pluginArgs>
                --extDbName      %PARENT_RESOURCE_NAME%
                --extDbRlsVer    %PARENT_RESOURCE_VERSION%
                --mapFile                @@gusHome@@/lib/xml/isf/FungiDB/cgdGFF32Gus.xml
                --inputFileOrDir         @@dataDir@@/candida_albicans_sc5314.transformed.gff3
                --inputFileExtension     "gff3"
                --fileFormat             gff3
                --soCvsVersion           @@SO_VER@@
                --defaultOrganism        "Candida albicans SC5314"
                --seqSoTerm              "chromosome"
                --validationLog          @@dataDir@@/validation.log
                --bioperlTreeOutput      @@dataDir@@/bioperlTree.out
                --seqIdColumn            source_id
                --naSequenceSubclass     ExternalNASequence
          </pluginArgs>

          <info
             displayName="Candida albicans (SC5314) genomic annotations"
             project="FungiDB"
             organisms="@@candida_albicans_sc5314_FUNGIDB_DISPLAY_NAME@@"
             category="Genome"
             publicUrl="http://candidagenome.org/download/gff/C_albicans_SC5314/"
	     contact="CGD Curator"
             email="candida-curator@genome.stanford.edu"
             institution="Candida Genome Database">
             <description>
               <![CDATA[
                    Candida albicans (SC5314) genomic annotations. Source: Candida Genome Database.
                ]]>
            </description>
          </info>
     </resource>

 <!-- //////////////////////
           ALIASES
       ////////////////////// -->

  <resource resource="candida_albicans_sc5314_primary_gene_aliases_RSRC" 
            version="@@candida_albicans_sc5314_GENOME_SEQUENCE_VER@@"
            plugin="ApiCommonData::Load::Plugin::InsertNaFeatureNaGene">


          <!-- Processing occurs upstream of the workflow now -->
          <manualGet fileOrDir="FungiDB/candida_albicans_sc5314/genome/%RESOURCE_VERSION%/primary_gene_aliases.tab"/> 

         <!-- Or as part of the workflow ...
         <manualGet fileOrDir="FungiDB/candida_albicans_sc5314/genome/%RESOURCE_VERSION%/C_albicans_SC5314_A21_features_with_chromosome_sequences.gff.gz" />
         <unpack>mv @@dataDir@@/C_albicans_SC5314_A21_features_with_chromosome_sequences.gff.gz @@dataDir@@/candida_albicans_sc5314.gff3.gz</unpack>
         <unpack>gunzip @@dataDir@@/candida_albicans_sc5314.gff3.gz</unpack>

        <unpack>
               fungidb_uniquify_and_standardize_seqids.pl
                   --input  @@dataDir@@/candida_albicans_sc5314.gff3
                   --output @@dataDir@@/candida_albicans_sc5314.uniquified.gff3
                   --prefix @@candida_albicans_sc5314_FUNGIDB_ABBREVIATION@@
                   --ignore_contigs
                   --mapping_file @@dataDir@@/primary_gene_aliases.tab
        </unpack>
        -->

    <pluginArgs>--MappingFile @@dataDir@@/primary_gene_aliases.tab</pluginArgs>
    <info
        displayName="Mapping of FungiDB IDs to original gene names."
        project="FungiDB"
        organisms="@@candida_albicans_sc5314_FUNGIDB_DISPLAY_NAME@@"
        category="ignore"
        publicUrl=""
	contact="CGD Curator"
	email="candida-curator@genome.stanford.edu"
	institution="Candida Genome Database">      
      <description>
        <![CDATA[
         
        ]]>
      </description>
    </info>
  </resource>


<!-- //////////////////////
           ONTOLOGIES
       ////////////////////// -->

       <!-- GO -->
       <resource 
           resource="candida_albicans_sc5314_go_associations_RSRC"
           version="@@candida_albicans_sc5314_GO_ASSOCIATIONS_VER@@"
           plugin="ApiCommonData::Load::Plugin::InsertGOAssociationsSimple">

           <wgetArgs url="http://candidagenome.org/download/go/gene_association.cgd.gz">--tries=5  --mirror --no-parent --no-host-directories --cut-dirs=5
           </wgetArgs>
           <unpack>gunzip @@dataDir@@/gene_association.cgd.gz</unpack>
<!--
          <manualGet 
              fileOrDir="FungiDB/candida_albicans_sc5314/gene_ontology/@@candida_albicans_sc5314_VER@@/gene_association.cgd" /> 
-->

          <unpack>
                fungidb_prepend_fungidb_identifier.pl
                     --input @@dataDir@@/gene_association.cgd
                     --output @@dataDir@@/gene_association.uniquified.cgd
                     --prefix @@candida_albicans_sc5314_FUNGIDB_ABBREVIATION@@
                     --col 2
                     --verbose
          </unpack>

          <pluginArgs>
                --externalDatabaseSpec "%RESOURCE_NAME%|%RESOURCE_VERSION%"
                --inputFile @@dataDir@@/gene_association.uniquified.cgd
                --goExternalDatabaseSpec "GO_RSRC|@@GO_VER@@"
                --seqIdSql "SELECT g.source_id, taf.aa_sequence_id FROM dots.genefeature g, dots.transcript t, dots.translatedAAFeature taf WHERE g.na_feature_id = t.parent_id AND t.na_feature_id = taf.na_feature_id UNION SELECT taf.source_id, taf.aa_sequence_id FROM dots.translatedAAFeature taf"
               --targetTable "DoTS::TranslatedAASequence"
               --lineOfEvidence "SGD"
               --inputIdColumn id
               --tolerateMissingSeqs
               --skipBadGOTerms @@dataDir@@/badGOTerms.log
         </pluginArgs>

         <info
              displayName="Candida albicans (SC5314) GO associations"
              project="FungiDB"
              organisms="@@candida_albicans_sc5314_FUNGIDB_DISPLAY_NAME@@"
              category="Proteome"
              publicUrl="http://candidagenome.org/download/go/"
	      contact="CGD Curator"
	      email="candida-curator@genome.stanford.edu"
	      institution="Candida Genome Database">
              <description>
                 <![CDATA[
                     Candida albicans (SC5314) GO associations. Source: Candida Genome Database.
                 ]]>
              </description>
          </info>
   </resource>

 <!-- //////////////////////
             DBXREFS
       ////////////////////// -->

   <!-- EC IDs NOT DONE -->
   <resource
          resource="candida_albicans_sc5314_ec_ids_RSRC" version="@@candida_albicans_sc5314_VER@@"
      plugin="GUS::Community::Plugin::InsertECMapping">

        <!-- Warning! Versioned URL. Will need to be updated! -->
        <wgetArgs url="http://candidagenome.org/download/chromosomal_feature_files/C_albicans_SC5314/C_albicans_SC5314_A21_chromosomal_feature.tab">--tries=5 --mirror --no-parent --no-host-directories --cut-dirs=5
         </wgetArgs>


    <!--
    <manualGet fileOrDir="FungiDB/candida_albicans_sc5314/IDs/%RESOURCE_VERSION%" />
   -->

    <!--
    Candida doesn't use their CGDIDs in their GFF files.  Let's map our uniqufied geneIDs (Calb_sc5314:...) to CGDIDs.
    -->

    <unpack>
          fungidb_unpack_sgd_ids.pl
              --input @@dataDir@@/dbxref.tab
              --output @@dataDir@@/ec_numbers.tab
              --db IUBMB
              --type "EC number"
    </unpack>

    <pluginArgs>
          --ECMappingFile @@dataDir@@/ec_numbers.tab
          --evidenceCode "SGD"
          --aaSeqLocusTagMappingSql "SELECT aa_sequence_id FROM dots.GeneFeature g, dots.Transcript t, dots.TranslatedAAFeature taf WHERE g.source_id = ? AND g.na_feature_id = t.parent_id AND t.na_feature_id = taf.na_feature_id"
    </pluginArgs>
    
    <info
        displayName="Candida albicans (SC5314) EC IDs"
        project="FungiDB"
        organisms="@@candida_albicans_sc5314_FUNGIDB_DISPLAY_NAME@@"
        category="Proteome"
        publicUrl=""
	contact="CGD Curator"
	email="candida-curator@genome.stanford.edu"
	institution="Candida Genome Database">
      <description>
        <![CDATA[
         Candida albicans (SC5314) EC IDs. Source: Candida Genome Database.         
        ]]>
      </description>
    </info>
  </resource>

 <!-- //////////////////////
             Aliases
       ////////////////////// -->
   <!-- Aliases -->
  <resource resource="candida_albicans_sc5314_gene_aliases_RSRC"
            version="@@candida_albicans_sc5314_VER@@"
            plugin="ApiCommonData::Load::Plugin::InsertDBxRefs">

        <!-- Warning! Versioned URL. Will need to be updated! -->
        <wgetArgs url="http://candidagenome.org/download/chromosomal_feature_files/C_albicans_SC5314/C_albicans_SC5314_A21_chromosomal_feature.tab">--tries=5  --mirror --no-parent --no-host-directories --cut-dirs=5
         </wgetArgs>
 
         <!--
          Candida doesn't use their CGDIDs in their GFF files.  Let's map our uniqufied geneIDs (Calb_sc5314:...) to CGDIDs.
          -->

         <unpack>
             fungidb_map_candida_ids_to_features.pl
                --input @@dataDir@@/C_albicans_SC5314_A21_chromosomal_feature.tab
                --output @@dataDir@@/gene_aliases.tab
                --prefix @@candida_albicans_sc5314_FUNGIDB_ABBREVIATION@@
         </unpack>

         <pluginArgs>
             --DbRefMappingFile @@dataDir@@/gene_aliases.tab
             --extDbName %RESOURCE_NAME% 
             --extDbReleaseNumber %RESOURCE_VERSION% 
             --columnSpec "primary_identifier,lowercase_primary_identifier" 
             --tableName "DbRefNASequence" 
         </pluginArgs>

         <info
             displayName="Candida albicans (SC5314) gene aliases"
             project="FungiDB"
             organisms="@@candida_albicans_sc5314_FUNGIDB_DISPLAY_NAME@@"
             category="ignore"
             publicUrl=""
	     contact="CGD Curator"
	     email="candida-curator@genome.stanford.edu"
	     institution="Candida Genome Database">
            <description>
               <![CDATA[
                      Candida albicans (SC5314) gene aliases. Source. CGD.  
               ]]>
            </description>
         </info>
    </resource>
    
    <!-- GeneIDs to refseq -->
    <resource resource="candida_albicans_sc5314_refseq_dbxrefs_RSRC"
              version="@@candida_albicans_sc5314_VER@@"
              plugin="ApiCommonData::Load::Plugin::InsertDBxRefs">

        <!-- Warning! Versioned URL. Will need to be updated! -->
        <wgetArgs url="http://candidagenome.org/download/chromosomal_feature_files/C_albicans_SC5314/C_albicans_SC5314_A21_chromosomal_feature.tab">--tries=5  --mirror --no-parent --no-host-directories --cut-dirs=5
         </wgetArgs>
 
         <unpack>gunzip @@dataDir@@/CGDID_2_RefSeqID.tab.gz</unpack>

         <!--
          Candida doesn't use their CGDIDs in their GFF files.  Let's map our uniqufied geneIDs (Calb_sc5314:...) to CGDIDs.
          -->

         <unpack>
             fungidb_map_candida_ids_to_features.pl
                --input               @@dataDir@@/C_albicans_SC5314_A21_chromosomal_feature.tab
                --id_to_dbxref        @@dataDir@@/CGDID_2_RefSeqID.tab
                --output @@dataDir    @@/geneid2entrez.tab
                --prefix @@candida_albicans_sc5314_FUNGIDB_ABBREVIATION@@
         </unpack>
 
         <pluginArgs>
              --DbRefMappingFile @@dataDir@@/gene2entrez.tab
              --extDbName %RESOURCE_NAME%
              --extDbReleaseNumber %RESOURCE_VERSION%
              --columnSpec "primary_identifier,secondary_identifier"
              --tableName "DbRefNAFeature" 
              --geneExternalDatabaseSpec 'candida_albicans_sc5314_RSRC|@@candida_albicans_sc5314_VER@@'
          </pluginArgs>
 
          <info
               displayName="Candida albicans (SC5314) Gene ID to Entrez dbxrefs"
               project="FungiDB"
               organisms="@@candida_albicans_sc5314_VER@@"
               category="ignore"
               publicUrl=""
	       contact="CGD Curator"
	       email="candida-curator@genome.stanford.edu"
	       institution="Candida Genome Database">
               <description>
                   <![CDATA[
                       Candida albicans (SC5314) Gene ID to Entrez dbxrefs. Source: CGD.
                  ]]>
                </description>
          </info>
     </resource>


     <resource resource="candida_albicans_sc5314_uniprot_dbxrefs_RSRC"
               version="@@candida_albicans_sc5314_uniprot_dbxrefs_VER@@"
               plugin="ApiCommonData::Load::Plugin::InsertDBxRefs">

        <!-- Warning! Versioned URL. Will need to be updated! -->

        <wgetArgs url="http://candidagenome.org/download/chromosomal_feature_files/C_albicans_SC5314/C_albicans_SC5314_A21_chromosomal_feature.tab">--tries=5  --mirror --no-parent --no-host-directories --cut-dirs=5
         </wgetArgs>

         <unpack>gunzip @@dataDir@@/gp2protein.cgd.gz</unpack>

         <!--
          Candida doesn't use their CGDIDs in their GFF files.  Let's map our uniqufied geneIDs (Calb_sc5314:...) to CGDIDs.
          -->

         <unpack>
             fungidb_map_candida_ids_to_features.pl
                --input               @@dataDir@@/C_albicans_SC5314_A21_chromosomal_feature.tab
                --id_to_dbxref        @@dataDir@@/gp2protein.cgd
                --output @@dataDir    @@/geneid2uniprot.tab
                --prefix @@candida_albicans_sc5314_FUNGIDB_ABBREVIATION@@
         </unpack>

         <pluginArgs>
               --DbRefMappingFile @@dataDir@@/geneid2uniprot.tab
               --extDbName %RESOURCE_NAME%
               --extDbReleaseNumber %RESOURCE_VERSION%
               --columnSpec "primary_identifier,secondary_identifier"
               --tableName "DbRefNAFeature"
               --geneExternalDatabaseSpec 'candida_albicans_sc5314_RSRC|@@candida_albicans_sc5314_VER@@'
         </pluginArgs>

         <info
              displayName="Candida albicans (SC5314) Gene IDs to UniProt dbxrefs"
              project="FungiDB"
              organisms="@@candida_albicans_sc5314_FUNGIDB_DISPLAY_NAME@@"
              category="ignore"
              publicUrl=""
	      contact="CGD Curator"
	      email="candida-curator@genome.stanford.edu"
	      institution="Candida Genome Database">	   
             <description>
                <![CDATA[  
                  Candida albicans (SC5314) Gene IDs to UniProt dbxrefs" 
                ]]>
             </description>
          </info>
      </resource>
  <!-- dbEST -->
  <resource resource="candida_albicans_sc5314_dbest_RSRC" version="@@candida_albicans_sc5314_DBEST_VER@@"
                                                          plugin="GUS::Supported::Plugin::dbEST">
    <manualGet fileOrDir="global/empty"/>
    <unpack>getSubTaxa --ncbiTaxId @@candida_albicans_sc5314_NCBI_TAXONOMY_ID@@ --outputFile @@dataDir@@/taxonIdFile</unpack>
    <unpack>createPropFile --file  @@dataDir@@/dbest.prop --propList "dbestLogin:@@dbestLogin@@,dbestPswd:@@dbestPswd@@"</unpack>
    <pluginArgs>--span 500 
                --taxonFile @@dataDir@@/taxonIdFile 
                --extDbName %RESOURCE_NAME% 
                --extDbRlsVer %RESOURCE_VERSION%
                --soVer @@SO_VER@@
                --dbestLoginFile @@dataDir@@/dbest.prop 
                --dbestConnect @@dbestConnect@@
    </pluginArgs>

    <info
        displayName="Candida albicans SC5314 dbEST ESTs"
        project="FungiDB"
        organisms="@@candida_albicans_sc5314_FUNGIDB_DISPLAY_NAME@@"
        category="Transcriptome"
        publicUrl="http://www.ncbi.nlm.nih.gov/dbEST/"
        contact=""
        email=""
        institution="">
      <description>
        <![CDATA[
         Candida albicans (SC5314) ESTs from dbEST.
        ]]>
      </description>
    </info>
  </resource>




</resources>
