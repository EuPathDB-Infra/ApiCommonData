<!-- Saccharomyces cerevisiae (S288C) Resources -->
<resources>

  <!-- ISF FASTA resource -->
  <resource
        resource="saccharomyces_cerevisiae_s288c_genome_sequence_RSRC"
        version="@@saccharomyces_cerevisiae_s288c_GENOME_SEQUENCE_VER@@"
        plugin="GUS::Supported::Plugin::LoadFastaSequences">

        <wgetArgs url="http://downloads.yeastgenome.org/chromosomal_feature/saccharomyces_cerevisiae.gff">
               --tries=5 
               --mirror 
                --no-parent
               --no-host-directories
               --cut-dirs=5
         </wgetArgs>

         <unpack>mv @@dataDir@@/saccharomyces_cerevisiae.gff @@dataDir@@/saccharomyces_cerevisiae_s288c.gff3</unpack>

<!--  Retain to switch back to manualDelivery
        <manualGet fileOrDir="FungiDB/saccharomyces_cerevisiae_s288c/genome/%RESOURCE_VERSION%/saccharomyces_cerevisiae_s288c.gff3"/>
-->

        <!-- Standardize scaffold IDs by prefixing -->
        <unpack>
               fungidb_uniquify_and_standardize_seqids.pl
                   --input  @@dataDir@@/saccharomyces_cerevisiae_s288c.gff3
                   --output @@dataDir@@/saccharomyces_cerevisiae_s288c.uniquified.gff3
                   --prefix @@saccharomyces_cerevisiae_s288c_ORGANISM_ABBREVIATION@@
        </unpack>

        <!-- Split FASTA from GFF -->
        <!-- Arg isn't input_file_or_dir but only input_dir (which can also be a file) -->
        <unpack>
             makeCustomFastaAndGffFromGff3
                  --input_dir    @@dataDir@@/saccharomyces_cerevisiae_s288c.uniquified.gff3
                  --inputFileExt gff3
                  --output_fasta @@dataDir@@/saccharomyces_cerevisiae_s288c.unpacked.fasta
                  --output_gff   @@dataDir@@/saccharomyces_cerevisiae_s288c.unpacked.gff3
        </unpack>

        <!-- There may not be a taxonomy ID for some organisms; Others don't seem to be present in the taxonomy -->
        <pluginArgs>
             --externalDatabaseName %RESOURCE_NAME%
             --externalDatabaseVersion %RESOURCE_VERSION% 
             --ncbiTaxId               @@neurospora_crassa_or74a_NCBI_TAXONOMY_ID@@
             --sequenceFile            @@dataDir@@/saccharomyces_cerevisiae_s288c.unpacked.fasta
             --SOTermName             'chromosome' 
             --regexSourceId          '>(\S+)'
             --tableName              "DoTS::ExternalNASequence"
             --regexChromosome        '\d+\.(\d+)'
         </pluginArgs>

         <info
             displayName="Saccharomyces cerevisiae (S288C) genome sequence"
             project="FungiDB"
             organisms="@@saccharomyces_cerevisiae_s288c_ORGANISM_FULL_NAME@@"
             category="Genome"
             publicUrl="http://www.yeastgenome.org/"
             contact=""
             email=""
             institution="SGD">
             <description>
                 <![CDATA[
                    Saccharomyces cerevisiae (S288C) genome sequence. Source: SGD.
             ]]>
             </description>
         </info>
  </resource>


  <!-- ISF genome annotations resource -->
  <resource
         resource="saccharomyces_cerevisiae_s288c_genome_annotations_RSRC"
         version="@@saccharomyces_cerevisiae_s288c_GENOME_SEQUENCE_VER@@" 
         parentResource="saccharomyces_cerevisiae_s288c_genome_sequence_RSRC"
         plugin="GUS::Supported::Plugin::InsertSequenceFeatures">

         <manualGet fileOrDir="FungiDB/saccharomyces_cerevisiae_s288c/genome/%RESOURCE_VERSION%/saccharomyces_cerevisiae_s288c.unpacked.gff3" />

         <!-- Assume that S. cerevisiae transcript IDs are already unique, created during fasta processing -->

         <!-- Run the standard ISF preprocess step -->
         <unpack>
               preprocessGFF3 
                   --input_gff  @@dataDir@@/saccharomyces_cerevisiae_s288c.unpacked.gff3
                   --output_gff @@dataDir@@/saccharomyces_cerevisiae_s288c.transformed.gff3
         </unpack>

         <pluginArgs>
                --extDbName          %PARENT_RESOURCE_NAME%
                --extDbRlsVer        %PARENT_RESOURCE_VERSION%
                --mapFile            @@gusHome@@/lib/xml/isf/FungiDB/sgdGFF32Gus.xml
                --inputFileOrDir     @@dataDir@@/saccharomyces_cerevisiae_s288c.transformed.gff3
                --inputFileExtension "gff3"
                --fileFormat         gff3
                --soCvsVersion       @@SO_VER@@
                --defaultOrganism    "Saccharomyces cerevisiae S288C"
                --seqSoTerm          "chromosome"
                --validationLog      @@dataDir@@/validation.log
                --bioperlTreeOutput  @@dataDir@@/bioperlTree.out
                --seqIdColumn        source_id
                --naSequenceSubclass ExternalNASequence
          </pluginArgs>

          <info
             displayName="Saccharomyces cerevisiae (S288C) genomic annotations"
             project="FungiDB"
             organisms="@@saccharomyces_cerevisiae_s288c_ORGANISM_FULL_NAME@@"
             category="Genome"
             publicUrl="http://www.yeastgenome.org/"
             contact=""
             email=""
             institution="SGD">
             <description>
               <![CDATA[
                    Saccharomyces cerevisiae (S288C) genomic annotations. Source: SGD.
                ]]>
            </description>
          </info>
     </resource>


     <!-- GO annotations resource -->
     <resource 
            resource="saccharomyces_cerevisiae_s288c_go_associations_RSRC"
            version="@@saccharomyces_cerevisiae_s288c_VER@@"
            plugin="ApiCommonData::Load::Plugin::InsertGOAssociationsSimple">
 
            <wgetArgs url="http://downloads.yeastgenome.org/literature_curation/gene_association.sgd.gz">
                 --tries=5 
                 --mirror 
                 --no-parent
                 --no-host-directories
                 --cut-dirs=5
            </wgetArgs>

            <unpack>gunzip @@dataDir@@/geneassociate.sgd.gz</unpack>

<!--  Retain to switch back to manualDelivery
            <manualGet fileOrDir="FungiDB/saccharomyces_cerevisiae_s288c/gene_ontology/@@saccharomyces_cerevisiae_s288c_VER@@/gene_association.sgd" />
--> 

            <pluginArgs>
                  --externalDatabaseSpec "%RESOURCE_NAME%|%RESOURCE_VERSION%"
                  --inputFile @@dataDir@@/gene_association.sgd
                  --goExternalDatabaseSpec "GO_RSRC|@@GO_VER@@"
                  --seqIdSql "SELECT g.source_id, taf.aa_sequence_id FROM dots.genefeature g, dots.transcript t, dots.translatedAAFeature taf WHERE g.na_feature_id = t.parent_id AND t.na_feature_id = taf.na_feature_id UNION SELECT taf.source_id, taf.aa_sequence_id FROM dots.translatedAAFeature taf"
                  --targetTable "DoTS::TranslatedAASequence"
                  --lineOfEvidence "SGD"
                  --inputIdColumn id
                  --tolerateMissingSeqs
                  --skipBadGOTerms @@dataDir@@/badGOTerms.log
            </pluginArgs>

            <info
                 displayName="Saccharomyces cerevisiae (S288C) GO associations"
                 project="FungiDB"
                 organisms="@@saccharomyces_cerevisiae_s288c_ORGANISM_FULL_NAME@@"
                 category="Proteome"
                 publicUrl="http://downloads.yeastgenome.org/literature_curation/gene_association.sgd.gz"
                 contact=""
                 email=""
                 institution="">
                 <description>
                    <![CDATA[
                        Saccharomyces cerevisiae (S288C) GO associations. Source: SGD.
                    ]]>
                 </description>
             </info>
      </resource>


      <!-- EC numbers -->
      <resource
          resource="saccharomyces_cerevisiae_s288c_ec_ids_RSRC" 
          version="@@saccharomyces_cerevisiae_s288c_VER@@"
          plugin="GUS::Community::Plugin::InsertECMapping">

            <wgetArgs url="http://downloads.yeastgenome.org/chromosomal_feature/dbxref.tab">
                 --tries=5 
                 --mirror 
                 --no-parent
                 --no-host-directories
                 --cut-dirs=5
            </wgetArgs>
   
<!--  Retain to switch back to manualDelivery
          <manualGet fileOrDir="FungiDB/saccharomyces_cerevisiae_s288c/@@saccharomyces_cerevisiae_s288c_VER@@/xrefs/%RESOURCE_VERSION%" />
 -->
          <unpack>
             fungidb_unpack_sgd_ids.pl
                 --input @@dataDir@@/dbxref.tab
                 --output @@dataDir@@/ec_numbers.tab
                 --db IUBMB
                 --type "EC number"
         </unpack>

         <pluginArgs>
              --ECMappingFile @@dataDir@@/ec_numbers.tab
              --evidenceCode "SGD"
              --aaSeqLocusTagMappingSql "SELECT aa_sequence_id FROM dots.GeneFeature g, dots.Transcript t, dots.TranslatedAAFeature taf WHERE g.source_id = ? AND g.na_feature_id = t.parent_id AND t.na_feature_id = taf.na_feature_id"
         </pluginArgs>
    
         <info
            displayName="Saccharomyces cerevisiae (S288C) EC IDs"
            project="FungiDB"
            organisms="@@saccharomyces_cerevisiae_s288c_ORGANISM_FULL_NAME@@"
            category="Proteome"
            publicUrl=""
            contact=""
            email=""
            institution="">
            <description>
               <![CDATA[
                 Saccharomyces cerevisiae (S288C) EC IDs. Source: SGD.                 
               ]]>
            </description>
         </info>
     </resource>


  <!-- dbEST -->
  <resource resource="saccharomyces_cerevisiae_s288c_dbest_RSRC" version="@@saccharomyces_cerevisiae_s288c_DBEST_VER@@"
                                                          plugin="GUS::Supported::Plugin::dbEST">
    <manualGet fileOrDir="global/empty"/>
    <unpack>getSubTaxa --ncbiTaxId @@saccharomyces_cerevisiae_s288c_NCBI_TAXONOMY_ID@@ --outputFile @@dataDir@@/taxonIdFile</unpack>
    <unpack>createPropFile --file  @@dataDir@@/dbest.prop --propList "dbestLogin:@@dbestLogin@@,dbestPswd:@@dbestPswd@@"</unpack>
    <pluginArgs>--span 500 
                --taxonFile @@dataDir@@/taxonIdFile 
                --extDbName %RESOURCE_NAME% 
                --extDbRlsVer %RESOURCE_VERSION%
                --soVer @@SO_VER@@
                --dbestLoginFile @@dataDir@@/dbest.prop 
                --dbestConnect @@dbestConnect@@
    </pluginArgs>

    <info
        displayName="Saccharomyces cerevisiae (S288C) dbEST ESTs"
        project="FungiDB"
        organisms="@@saccharomyces_cerevisiae_s288c_ORGANISM_FULL_NAME@@"
        category="Transcriptome"
        publicUrl="http://www.ncbi.nlm.nih.gov/dbEST/"
        contact=""
        email=""
        institution="">
      <description>
        <![CDATA[
         Saccharomyces cerevisiae ESTs from dbEST.
        ]]>
      </description>
    </info>
  </resource>

</resources>
