<!-- Aspergillus nidulans (A4) AspGD Resources -->

<resources>

  <!-- ISF FASTA resource -->
  <resource
        resource="aspergillus_nidulans_a4_aspgd_genome_sequence_RSRC"
        version="@@aspergillus_nidulans_a4_aspgd_GENOME_SEQUENCE_VER@@"
        plugin="GUS::Supported::Plugin::LoadFastaSequences">


            <!-- Transforming upstream of ISF/workflow... -->                        
            <manualGet 
              fileOrDir="FungiDB/aspergillus_nidulans_a4_aspgd/genome/%RESOURCE_VERSION%/aspergillus_nidulans_a4.unpacked.fasta"/>

            <!-- or within the workflow itself... 
                 see github:script/mirror_aspgd_data.sh for details
		 -->	   
                 <manualGet 
                  fileOrDir="FungiDB/aspergillus_nidulans_a4-aspgd/genome/%RESOURCE_VERSION%/aspergillus_nidulans_a4.gff3"/>

                 <unpack>
                    fungidb_uniquify_and_standardize_seqids.pl
                      --input  @@dataDir@@/aspergillus_nidulans_a4.gff3
                      --output @@dataDir@@/aspergillus_nidulans_a4.uniquified.gff3
                      --prefix @@aspergillus_nidulans_a4_FUNGIDB_ABBREVIATION@@
               </unpack>

               <unpack>
                  makeCustomFastaAndGffFromGff3
                      --input_dir @@dataDir@@/aspergillus_nidulans_a4.uniquified.gff3
                      --inputFileExt gff3
                      --output_fasta @@dataDir@@/aspergillus_nidulans_a4.unpacked.fasta
                      --output_gff   @@dataDir@@/aspergillus_nidulans_a4.unpacked.gff3
               </unpack>

        <pluginArgs>
             --externalDatabaseName %RESOURCE_NAME%
             --ncbiTaxId 227321
             --externalDatabaseVersion %RESOURCE_VERSION%
             --sequenceFile @@dataDir@@/aspergillus_nidulans_a4.unpacked.fasta
             --SOTermName 'chromosome' 
             --regexSourceId  '>(\S+)'
             --tableName "DoTS::ExternalNASequence"
             --regexChromosome 'AnidA4A:(.*)_nidulans.*'
         </pluginArgs>

         <info
             displayName="Aspergillus nidulans (A4) AspGD genomic sequence"
             project="FungiDB"
             organisms="@@aspergillus_nidulans_a4_aspgd_FUNGIDB_DISPLAY_NAME@@"
             category="Genome"
	     publicUrl="http://www.aspergillusgenome.org/"
             contact="AspGD curator"
             email="aspergillus-curator@genome.stanford.edu"
             institution="AspGD">
             <description>
                 <![CDATA[
                  Aspergillus nidulans (A4) genomic sequence. Source: AspGD.
             ]]>
             </description>
         </info>
  </resource>


  <!-- ISF genomic annotations resource -->
  <resource
         resource="aspergillus_nidulans_a4_aspgd_genome_annotations_RSRC"
         version="@@aspergillus_nidulans_a4_aspgd_GENOME_SEQUENCE_VER@@" 
         parentResource="aspergillus_nidulans_a4_aspgd_genome_sequence_RSRC"
         plugin="GUS::Supported::Plugin::InsertSequenceFeatures">

         <!-- Transforming upstream of ISF/workflow... -->            
        <manualGet fileOrDir="FungiDB/aspergillus_nidulans_a4-aspgd/genome/%RESOURCE_VERSION%/aspergillus_nidulans_a4.transformed.gff3" />

        <!-- or within the workflow iteself... THIS IS BROKEN -->

                <manualGet fileOrDir="FungiDB/aspergillus_nidulans_a4/genome/%RESOURCE_VERSION%/aspergillus_nidulans_a4.unpacked.gff3" />
                <unpack>
                      fungidb_uniquify_and_standardize_seqids.pl
                      --input  @@dataDir@@/aspergillus_nidulans_a4_transcripts.gff3
                      --output @@dataDir@@/aspergillus_nidulans_a4.uniquified.gff3
                      --prefix @@aspergillus_nidulans_a4_FUNGIDB_ABBREVIATION@@
                </unpack>
       
                <unpack>
                     preprocessGFF3 
                         --input_gff  @@dataDir@@/aspergillus_nidulans_a4.unpacked.gff3
                         --output_gff @@dataDir@@/aspergillus_nidulans_a4.transformed.gff3
               </unpack>
         -->

         <pluginArgs>
                --extDbName      %PARENT_RESOURCE_NAME%
                --extDbRlsVer    %PARENT_RESOURCE_VERSION%
                --mapFile        @@gusHome@@/lib/xml/isf/FungiDB/cgdGFF32Gus.xml
                --inputFileOrDir @@dataDir@@/aspergillus_nidulans_a4.transformed.gff3
                --inputFileExtension "gff3"
                --fileFormat     gff3
                --soCvsVersion   @@SO_VER@@
                --defaultOrganism "@@aspergillus_nidulans_a4_aspgd_NCBI_DISPLAY_NAME@@"
                --seqSoTerm         "chromosome"
                --validationLog     @@dataDir@@/validation.log
                --bioperlTreeOutput @@dataDir@@/bioperlTree.out
                --seqIdColumn source_id
                --naSequenceSubclass ExternalNASequence
          </pluginArgs>

          <info
             displayName="Aspergillus nidulans (A4) AspGD genomic annotations"
             project="FungiDB"
             organisms="@@aspergillus_nidulans_a4_aspgd_FUNGIDB_DISPLAY_NAME@@"
             category="Genome"
             publicUrl="http://www.aspergillusgenome.org/"
             contact="AspGD curator"
             email="aspergillus-curator@genome.stanford.edu"
             institution="AspGD">
             <description>
               <![CDATA[
                    Aspergillus nidulans (A4) genomic annotations. Source: AspGD.
                ]]>
            </description>
          </info>
     </resource>

 <!-- //////////////////////
           ALIASES
       ////////////////////// -->

  <resource resource="aspergillus_nidulans_a4_aspgd_primary_gene_aliases_RSRC" 
            version="@@aspergillus_nidulans_a4_aspgd_GENOME_SEQUENCE_VER@@"
            plugin="ApiCommonData::Load::Plugin::InsertNaFeatureNaGene">
 
    <manualGet fileOrDir="FungiDB/aspergillus_nidulans_a4-aspgd/genome/%RESOURCE_VERSION%/primary_gene_aliases.tab"/>
    <pluginArgs>--MappingFile @@dataDir@@/primary_gene_aliases.tab</pluginArgs>
    <info
        displayName="Mapping of FungiDB IDs to original gene names."
        project="FungiDB"
        organisms="@@aspergillus_nidulans_a4_aspgd_FUNGIDB_DISPLAY_NAME@@"
        category="ignore"
	publicUrl="http://www.aspergillusgenome.org/"
	contact="AspGD curator"
	email="aspergillus-curator@genome.stanford.edu"
	institution="AspGD">      
      <description>
        <![CDATA[
         
        ]]>
      </description>
    </info>
  </resource>


  <!-- GO annotations resource -->
  <resource 
         resource="aspergillus_nidulans_a4_aspgd_go_associations_RSRC"
         version="@@aspergillus_nidulans_a4_aspgd_VER@@"
         plugin="ApiCommonData::Load::Plugin::InsertGOAssociationsSimple">
    
         <manualGet 
              fileOrDir="FungiDB/aspergillus_nidulans_a4aspgd/gene_ontology/@@aspergillus_nidulans_a4_aspgd_VER@@/gene_association.sgd" />
 
         <pluginArgs>
               --externalDatabaseSpec "%RESOURCE_NAME%|%RESOURCE_VERSION%"
               --inputFile @@dataDir@@/gene_association.sgd
               --goExternalDatabaseSpec "GO_RSRC|@@GO_VER@@"
               --seqIdSql "SELECT g.source_id, taf.aa_sequence_id FROM dots.genefeature g, dots.transcript t, dots.translatedAAFeature taf WHERE g.na_feature_id = t.parent_id AND t.na_feature_id = taf.na_feature_id UNION SELECT taf.source_id, taf.aa_sequence_id FROM dots.translatedAAFeature taf"
              --targetTable "DoTS::TranslatedAASequence"
              --lineOfEvidence "AspGD"
              --inputIdColumn id
              --tolerateMissingSeqs
              --skipBadGOTerms @@dataDir@@/badGOTerms.log
         </pluginArgs>

         <info
              displayName="Aspergillus nidulans (A4) GO AspGD associations"
              project="FungiDB"
              organisms="@@aspergillus_nidulans_a4_aspgd_FUNGIDB_DISPLAY_NAME@@"
              category="Proteome"
	      publicUrl="http://www.aspergillusgenome.org/"
	      contact="AspGD curator"
	      email="aspergillus-curator@genome.stanford.edu"
	      institution="AspGD">
              <description>
                 <![CDATA[
                     Aspergillus nidulans (A4) AspGD GO associations"                     
                 ]]>
              </description>
          </info>
   </resource>

   
   <!-- EC numbers -->
   <resource
          resource="aspergillus_nidulans_a4_aspgd_ec_ids_RSRC" 
          version="@@aspergillus_nidulans_a4_aspgd_VER@@"
      plugin="GUS::Community::Plugin::InsertECMapping">
  
    <manualGet fileOrDir="FungiDB/aspergillus_nidulans_a4_aspgd/xrefs/%RESOURCE_VERSION%" />
    <unpack>
          fungidb_unpack_sgd_ids.pl
              --input @@dataDir@@/dbxref.tab
              --output @@dataDir@@/ec_numbers.tab
              --db IUBMB
              --type "EC number"
    </unpack>

    <pluginArgs>
          --ECMappingFile @@dataDir@@/ec_numbers.tab
          --evidenceCode "AspGD"
          --aaSeqLocusTagMappingSql "SELECT aa_sequence_id FROM dots.GeneFeature g, dots.Transcript t, dots.TranslatedAAFeature taf WHERE g.source_id = ? AND g.na_feature_id = t.parent_id AND t.na_feature_id = taf.na_feature_id"
    </pluginArgs>
    
    <info
        displayName="Aspergillus nidulans (A4) AspGD EC IDs"
        project="FungiDB"
        organisms="@@aspergillus_nidulans_a4_aspgd_FUNGIDB_DISPLAY_NAME@@"
        category="Proteome"
	publicUrl="http://www.aspergillusgenome.org/"
	contact="AspGD curator"
	email="aspergillus-curator@genome.stanford.edu"
	institution="AspGD">
      <description>
        <![CDATA[
           Aspergillus nidulans (A4) AspGD EC IDs
        ]]>
      </description>
    </info>
  </resource>


  <!-- dbEST -->
  <resource resource="aspergillus_nidulans_a4_aspgd_dbest_RSRC" version="@@aspergillus_nidulans_a4_aspgd_DBEST_VER@@"
                                                          plugin="GUS::Supported::Plugin::dbEST">
    <manualGet fileOrDir="global/empty"/>
    <unpack>getSubTaxa --ncbiTaxId @@aspergillus_nidulans_a4_aspgd_NCBI_TAXONOMY_ID@@ --outputFile @@dataDir@@/taxonIdFile</unpack>
    <unpack>createPropFile --file  @@dataDir@@/dbest.prop --propList "dbestLogin:@@dbestLogin@@,dbestPswd:@@dbestPswd@@"</unpack>
    <pluginArgs>--span 500 
                --taxonFile @@dataDir@@/taxonIdFile 
                --extDbName %RESOURCE_NAME% 
                --extDbRlsVer %RESOURCE_VERSION%
                --soVer @@SO_VER@@
                --dbestLoginFile @@dataDir@@/dbest.prop 
                --dbestConnect @@dbestConnect@@
    </pluginArgs>

    <info
        displayName="Aspergillus nidulans (A4; AspGD) dbEST ESTs"
        project="FungiDB"
        organisms="@@aspergillus_nidulans_a4_aspgd_FUNGIDB_DISPLAY_NAME@@"
        category="Transcriptome"
        publicUrl="http://www.ncbi.nlm.nih.gov/dbEST/"
        contact=""
        email=""
        institution="">
      <description>
        <![CDATA[
         Aspergillus nidulans (A4; AspGD) ESTs from dbEST.
        ]]>
      </description>
    </info>
  </resource>


</resources>




