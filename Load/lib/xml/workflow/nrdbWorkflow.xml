<workflow name="nrdb">
  <params>
    <param name="nrdbExtDbRlsSpec"/>
    <param name="nrdbOuputFile"/>
    <param name="nrdbShortDeflineOutputFile"/>
  </param>

  <constants>
  </constants>

  <steps>
    <step name="NRDB" subflow="resource" global="true"/>
      <paramValue name="extDbRlsSpec">$nrdbExtDbRlsSpec</paramValue>
    </step>

    <step name="copyNrdbFile" class="ApiCommonData::Load::Steps::MoveDownloadFile">
      <paramValue name="fromFile">NRDB/nr.gz</paramValue>
      <paramValue name="toFile">$nrdbOutputFile</paramValue>
      <depends step="NRDB"/>
    </step>

    <step name="shortenNrdbDefline" class="ApiCommonData::Load::Steps::ShortenDefline">
      <paramValue name="fromFile">seqfiles/nr</paramValue>
      <paramValue name="toFile">$nrdbShortDeflineOutputFile</paramValue>
      <depends step="copyNrdbFile"/>
    </step>

    <step name="copyNrdbFileToCluster" class="ApiCommonData::Load::Steps::CopyFilesToComputeCluster">
      <paramValue name="file">$nrdbOutputFile</paramValue>
      <paramValue name="dir">seqfiles</paramValue>
      <depends step="copyNrdbFile"/>
    </step>

    <step name="copyNrdbShortDeflineFileToCluster" class="ApiCommonData::Load::Steps::CopyFilesToComputeCluster">
      <paramValue name="file">$nrdbShortDeflineOutputFile</paramValue>
      <paramValue name="dir">seqfiles</paramValue>
      <depends step="shortenNrdbDefline"/>
    </step>

  </steps>

</workflow>
