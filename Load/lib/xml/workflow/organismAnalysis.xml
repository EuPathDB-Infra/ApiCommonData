<workflowGraph name="organismAnalysis">
  <param name="projectDB"/>
  <param name="projectRelease"/>
  <param name="parentDataDir"/>
  <param name="organismName"/>
  <param name="organismTwoLetterAbbrev"/>
  <param name="genomeExtDb"/>
  <param name="genomeExtDbRls"/>
  <param name="genomeVirtualSeqExtDb"/>
  <param name="genomeVirtualSeqExtDbRls"/>
  <param name="genomeSource"/>
  <param name="interproVersion"/>
  <param name="iedbVersion"/>
  <param name="soVersion"/>
  <param name="dbESTVersion"/>
  <param name="tigrVersion"/>
  <param name="ncbiTaxonVersion"/>
  <param name="ncbiTaxonId"/>
  <param name="parentNcbiTaxonId"/>
  <param name="predictedTranscriptsSql"/>
  <param name="pdbOutputFile"/>
  <param name="nrdbOutputFile"/>
  <param name="nrdbShortDeflineFile"/>  
  <param name="maxIntronSize"/>
  <param name="calculateTranslatedProteins"/>
  <param name="taxonHierarchyForBlastxFilter"/>
  <param name="runSplign"/>
  <param name="nrdbExtDbRlsSpec"/>


  <constant name="dataDir">$$parentDataDir$$/$$organismName$$</constant>
  <constant name="downloadSiteDataDir">downloadSite/$$projectDB$$/$$projectRelease$$/$$organismName$$</constant>
  <constant name="webServicesBlastDataDir">/files/cbil/data/cbil/apiSiteFiles/webServices/$$projectDB$$/$$projectRelease$$/blast</constant>

  <step name="makeDataDir" stepClass="ApiCommonData::Load::WorkflowSteps::MakeDataDir">
    <paramValue name="dataDir">$$dataDir$$</paramValue>
  </step>

  <step name="makeDownloadSiteDataDir" stepClass="ApiCommonData::Load::WorkflowSteps::MakeApiSiteFilesDir">
    <paramValue name="apiSiteFilesDir">$$downloadSiteDataDir$$</paramValue>
  </step>

  <subgraph name="genomeAnalysis" xmlFile="genomeAnalysis.xml">
    <paramValue name="parentDataDir">$$dataDir$$</paramValue>
    <paramValue name="organismName">$$organismName$$</paramValue>
    <paramValue name="genomeExtDb">$$genomeExtDb$$</paramValue>
    <paramValue name="genomeExtDbRls">$$genomeExtDbRls$$</paramValue>
    <paramValue name="genomeVirtualExtDb">$$genomeVirtualSeqExtDb$$</paramValue>
    <paramValue name="genomeVirtualExtDbRls">$$genomeVirtualSeqExtDbRls$$</paramValue>
    <paramValue name="tigrVersion">$$tigrVersion$$</paramValue>
    <paramValue name="soVersion">$$soVersion$$</paramValue>
    <paramValue name="ncbiTaxonVersion">$$ncbiTaxonVersion$$</paramValue>
    <paramValue name="ncbiTaxonId">$$ncbiTaxonId$$</paramValue>    
    <paramValue name="parentNcbiTaxonId">$$parentNcbiTaxonId$$</paramValue>
    <paramValue name="predictedTranscriptsSql"></paramValue>
    <paramValue name="nrdbFile">$$nrdbOutputFile$$</paramValue>
    <paramValue name="nrdbShortDeflineOutputFile">$$nrdbShortDeflineFile$$</paramValue>
    <paramValue name="maxIntronSize">$$maxIntronSize$$</paramValue>
    <paramValue name="taxonHierarchyForBlastxFilter">$$taxonHierarchyForBlastxFilter$$</paramValue>
    <paramValue name="runSplign">$$runSplign$$</paramValue>
    <paramValue name="nrdbExtDbRlsSpec">$$nrdbExtDbRlsSpec$$</paramValue>
    <paramValue name="organismTwoLetterAbbrev">$$organismTwoLetterAbbrev$$</paramValue>

    <depends name="makeDataDir"/>
  </subgraph>

  <subgraph name="proteomeAnalysis" xmlFile="proteomeAnalysis.xml">
    <paramValue name="parentDataDir">$$dataDir$$</paramValue>
    <paramValue name="organismTwoLetterAbbrev">$$organismTwoLetterAbbrev$$</paramValue>
    <paramValue name="genomeExtDbRlsSpec">$$genomeExtDb$$|$$genomeExtDbRls$$</paramValue>
    <paramValue name="iedbVersion">$$iedbVersion$$</paramValue>
    <paramValue name="soVersion">$$soVersion$$</paramValue>
    <paramValue name="interproVersion">$$interproVersion$$</paramValue>
    <paramValue name="nrdbExtDbRlsSpec">$$nrdbExtDbRlsSpec$$</paramValue>
    <paramValue name="nrdbExtDbRlsSpec">$$soExtDbRlsSpec$$</paramValue>
    <paramValue name="nrdbFile">$$nrdbFile$$</paramValue>
    <paramValue name="nrdbShortDeflineFile">$$nrdbShortDeflineFile$$</paramValue>
    <paramValue name="pdbFile">$$pdbFile$$</paramValue>
    <paramValue name="calculateTranslatedProteins">$$calculateTranslatedProteins$$</paramValue>
    <paramValue name="ncbiTaxonId">$$ncbiTaxonId$$</paramValue>
    <depends name="makeDataDir"/>
  </subgraph>


  <subgraph name="makeAndFormatDownloadFiles" xmlFile="makeAndFormatDownloadFiles.xml">
    <paramValue name="downloadSiteDataDir">$$downloadSiteDataDir$$</paramValue>
    <paramValue name="webServiceBlastsDataDir">$$webServicesBlastDataDir$$</paramValue>
    <paramValue name="organismName">$$ncbiTaxonId$$</paramValue>
    <paramValue name="ncbiTaxonId">$$organismTwoLetterAbbrev$$</paramValue>
    <paramValue name="genomeExtDbRlsSpec">$$genomeExtDb$$|$$genomeExtDbRls$$</paramValue>
    <paramValue name="genomeVirtualSeqExtDbRlsSpec">$$genomeVirtualSeqExtDbRlsSpec$$</paramValue>
    <paramValue name="interproVersion">$$interproVersion$$</paramValue>
    <paramValue name="genomeSource">$$genomeSource$$</paramValue>
    <paramValue name="projectDB">$$projectDB$$</paramValue>
    <paramValue name="projectRelease">$$projectRelease$$</paramValue>
    <paramValue name="dbESTExtDbRlsSpec">dbEST:$$dbESTVersion$$</paramValue>
    <depends name="proteomeAnalysis"/>
    <depends name="genomeAnalysis"/>
    <depends name="makedownloadSiteDataDir"/>
  </subgraph>

  <subgraph name="makeGffFile" xmlFile="makeGffFile.xml">
    <paramValue name="downloadSiteDataDir">$$downloadSiteDataDir$$</paramValue>
    <paramValue name="organismName">$$organismName$$</paramValue>
    <paramValue name="organismFullName">$$organismFullName$$</paramValue>
    <paramValue name="projectDB">$$projectDB$$</paramValue>
    <depends name="proteomeAnalysis"/>
    <depends name="genomeAnalysis"/>
    <depends name="makedownloadSiteDataDir"/>
  </subgraph>

  <step name="fullRecordDump" stepClass="ApiCommonData::Load::WorkflowSteps::RunfullRecordDump">
    <paramValue name="downloadSiteDataDir">$$downloadSiteDataDir$$</paramValue>
    <paramValue name="organismName">$$organismName$$</paramValue>
    <paramValue name="organismFullName">$$organismFullName$$</paramValue>
    <paramValue name="projectDB">$$projectDB$$</paramValue>
    <depends name="proteomeAnalysis"/>
    <depends name="genomeAnalysis"/>
    <depends name="makedownloadSiteDataDir"/>
  </step>
</workflowGraph>
