#!/usr/bin/perl


use strict;
use lib "$ENV{GUS_HOME}/lib/perl";
use Getopt::Long;
use GUS::Supported::GusConfig;


my $gusConfigFile = $ENV{GUS_HOME} . "/config/gus.config";

my $gusconfig = GUS::Supported::GusConfig->new($gusConfigFile);

my $db = $1 if ($gusconfig->getDbiDsn()=~ m/:(\w+\-*\w*)$/);

my $login = $gusconfig->getDatabaseLogin();

my $password = $gusconfig->getDatabasePassword();

&runSql($login, $password, $db, 'patch_siRNA.sql');


sub runSql {

  my ($login, $password, $db, $file) = @_;

  my $fullFile = "$ENV{GUS_HOME}/lib/sql/apidbschema/$file";

  -e $fullFile || die "File '$fullFile' does not exist";

  my $cmd = "sqlplus $login\@$db/$password \@$fullFile";

  system($cmd);

  my $status = $? >> 8;

  die "Failed with status '$status running cmd: $cmd'" if $status;
}

exit 1;



