#!/usr/bin/perl

my $fastaFile = $ARGV[0];

usage() unless $fastaFile;

open(F, $fastaFile) || die "Can't open fasta file '$fastaFile'\n";

my $id;
my $seq;
while (<F>) {
  chomp;
  next if /^\s*$/;  # skip white space lines
  if (/^>/) {
    if (/^>\s*(.+)\s*$/) {
      if ($seq) {
	print "$id\t$seq\n";
	$seq = '';
      }
      $id = $1;
    }
    else {
      die "Can't find ID on line $. of $fastaFile\n";
    }
  }
  else {
    $seq .= $_;
    die "No ID found for sequence on line $.\n" unless $id;
  }
}

print "$id\t$seq\n";

sub usage {
    print STDERR "
Make a two column tab file, as expected by GGTools' get_pbase-tbase.pl (name, sequence) from a FASTA file with single line sequence.  Output to stdout.

usage: probeFasta2Tab fasta_file

";
    exit(1);

}

