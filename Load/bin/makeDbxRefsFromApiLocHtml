#!/usr/bin/perl

use strict;

my $apilocHtmlFile = $ARGV[0];
my $organismFullName = $ARGV[1];

usage() unless $apilocHtmlFile;

$organismFullName =~ s/ /%20/;

# <li><a href="/apiloc/apiloc/gene/Neospora%20caninum/NCLIV_036400">NCLIV_036400</a> (GRA1)

my %ids;
open(F, $apilocHtmlFile) || die "can't open html file '$apilocHtmlFile'";
while(<F>){
  next if /common/;  # skip a junky line of html
  next unless /gene\/$organismFullName\/(.*?)\"/;
  print "$1\thttp://apiloc.bio21.unimelb.edu.au/apiloc/apiloc/gene/$organismFullName/$1\n" unless ($ids{$1});
  $ids{$1}=1;
}

sub usage {
  print STDERR "

Scrape IDs from an ApiLoc html file (eg, http://apiloc.bio21.unimelb.edu.au/apiloc/apiloc/species/Plasmodium%20falciparum).

output dbxrefs.

usage:  makeDbxRefsFromApiLocHtml apiloc_html_file organism_full_name

(organism full name is the one used at ApiLoc.org)


";

  exit(1);
}
