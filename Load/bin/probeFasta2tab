#!/usr/bin/perl

my $fastaFile = $ARGV[0];

usage() unless $fastaFile;

open(F, $fastaFile);

my $id;
while (<F>) {
    chomp;
    next if /^\s*$/;  # skip white space lines
    if (/^>/) {
	if (/^>\s*(.+)\s*$/) {
	    die "Didn't find sequence for ID $id on line $.\n" if $id;
	    $id = $1;
	} else {
	    die "Can't find ID on line $. of $fastaFile\n";
	}
    } else {
	die "No ID found for sequence on line $.\n" unless $id;
	print "$id\t$_\n";
	$id = 0;
    }
}

sub usage {
    print STDERR "
Make a two column tab file, as expected by GGTools' get_pbase-tbase.pl (name, sequence) from a FASTA file with single line sequence.  Output to stdout.

usage: probeFasta2Tab fasta_file

";
    exit(1);

}
