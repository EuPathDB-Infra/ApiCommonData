#!/usr/bin/perl

use lib "$ENV{GUS_HOME}/lib/perl";
use strict;
use Getopt::Long;
use Bio::SeqIO;
use File::Basename;
use Data::Dumper;

my ($verbose, $help, $inputGff,$outputGff, $errList);


&GetOptions('verbose' => \$verbose,
            'help|h' => \$help,
            'input_gff=s' => \$inputGff,
	    'output_gff=s' => \$outputGff,
            'feat_list=s' => \$errList,

 
           );

&usage() if($help);
&usage("Missing a Required Argument") unless(defined $inputGff && $outputGff && $errList);

open(ERRLIST,"$errList");
open(INGFF,"$inputGff");
open(OUTGFF,">$outputGff");


my %ids;

foreach my $line (<ERRLIST>){
    
    chomp $line;

    if (!($line =~ /^\s+$/)){
	my($id,$type) = split(/\:/,$line);


	if($id eq "match"){
	    my @cols = split(/\:/,$type);

	    $id .= ":$cols[0]";
	}
	$ids{$id} = $id;
    }



}



foreach my $line(<INGFF>){
    chomp $line;

    my(@cols) = split(/\t/,$line);


    my($tag) = split(/\;/,$cols[8]);

    my($tagname,$value) = split(/\s/,$tag);

    $value =~ s/^\"//;
    $value =~ s/\"$//;


    if($value eq 'LbrM02_V2.0315:ncRNA'){

	$line =~ s/mRNA/ncRNA/g;
    }
    my($id,$type) = split(/\:/,$value);


    if($id eq "match"){
	my @cols = split(/\:/,$type);
	
	$id .= ":$cols[0]";
    }

   

    if(!($ids{$id})){
	print OUTGFF "$line\n";
    }else{
        print STDERR "$value will not be loaded\n";
    }
    
}

close(IN);
close(OUT);
close(OUTGFF);


sub usage{

}
