<wdkModel>

  <!--===========================================================================-->
  <!-- Params  -->
  <!--===========================================================================-->

    <paramSet name="EstParams">

      <!------------------------------------------------------------------>
      <!-- Organism  -->
      <!------------------------------------------------------------------>
      <flatVocabParam name="organism"
                     queryRef="EstVocabQueries.Organism"
                     prompt="Organism"
                     multiPick="true">
        <help>
           <text>
             Select one or more organisms.
           </text>
        </help>
      </flatVocabParam>


      <!------------------------------------------------------------------>
      <!--   -->
      <!------------------------------------------------------------------>
      <stringParam name="est_id"
                     prompt="EST ID"
                     substitute="yes">
            <help>Enter an EST ID (Accession Number)</help>
            <suggest sample="AU087658, BQ739759, N98084"
                     default="AU087658"/>
      </stringParam>


      <!------------------------------------------------------------------>
      <!-- Blast database organism  -->
      <!------------------------------------------------------------------>
      <enumParam name="BlastDatabaseOrganism"
                     prompt="Organism"
                     multiPick="false"
        <help>
           <text>
             Organism(s) from which the sequences in the BLAST database originated
           </text>
        </help>
        <enumList>
          <enumValue term="P. berghei" includeProjects="ApiDB,PlasmoDB"
                 internal=   "Pberghei"/>
          <enumValue term="P. chabaudi" includeProjects="ApiDB,PlasmoDB"
                 internal=   "Pchabaudi"/>
          <enumValue term="P. falciparum" includeProjects="ApiDB,PlasmoDB"
                 internal=   "Pfalciparum"/>
          <enumValue term="P. falciparum mitocondrial" includeProjects="ApiDB,PlasmoDB"
                 internal=   "PfalciparumMito"/>
          <enumValue term="P. falciparum plastid" includeProjects="ApiDB,PlasmoDB"
                 internal=   "PfalciparumPlastid"/>
          <enumValue term="P. knowlesi" includeProjects="ApiDB,PlasmoDB"
                 internal=   "Pknowlesi"/>
          <enumValue term="P. vivax" includeProjects="ApiDB,PlasmoDB"
                 internal=   "Pvivax"/>
          <enumValue term="P. yoelii" includeProjects="ApiDB,PlasmoDB"
                 internal=   "Pyoelii"/>
          <enumValue term="any" includeProjects="ApiDB,PlasmoDB"
                 internal=   "Plasmodium"/>

          <enumValue term="T. gondii ME49"  includeProjects="ApiDB,ToxoDB"
                 internal=   "Tgondii"/> 
          <enumValue term="T. gondi apicoplast" includeProjects="ApiDB,ToxoDB"
                 internal=   "TgondiiApicoplast"/>
          <enumValue term="T. gondii GT1"  includeProjects="ApiDB,ToxoDB"
                 internal=   "TgondiiGT1"/> 
          <enumValue term="T. gondii RH (chr Ia, Ib)"  includeProjects="ApiDB,ToxoDB"
                 internal=   "TgondiiRH"/> 
          <enumValue term="T. gondii VEG"  includeProjects="ApiDB,ToxoDB"
                 internal=   "TgondiiVeg"/> 

          <enumValue term="C. hominis" includeProjects="ApiDB,CryptoDB"
                 internal=   "Chominis"/> 
          <enumValue term="C. parvum" includeProjects="ApiDB,CryptoDB"
                 internal=   "Cparvum"/> 
          <enumValue term="C. parvum Chr6" includeProjects="ApiDB,CryptoDB"
                 internal=   "CparvumChr6"/> 
          <enumValue term="C. muris"
                 internal=   "Cmuris"/> 
          <enumValue term="C. parvum EST"
                 internal=   "CparvumEST"/> 

        </enumList>
      </enumParam>

      <!------------------------------------------------------------------>
      <!-- Blast database type  -->
      <!------------------------------------------------------------------>
      <enumParam name="BlastDatabaseType"
                     prompt="Target"
                     multiPick="false">
        <help>
           <text>
             The type of sequence you want to BLAST against (the subject)
           </text>
        </help>
        <enumList>
          <enumValue term="EST"
                 internal=   "ESTs"/>
          <enumValue term="Translated EST"
                 internal=   "ESTs Translated"/>
        </enumList>
      </enumParam>

  </paramSet>


  <!--===========================================================================-->
  <!-- Vocab Queries  -->
  <!--===========================================================================-->

  <querySet name="EstVocabQueries">

        <sqlQuery name="Organism">
            <column name="internal"/>
            <column name="term"/>
             <sql>
                SELECT orgs.term, orgs.internal
                FROM (SELECT tn.name AS term, t.taxon_id AS internal
                      FROM sres.TaxonName tn, sres.taxon t
                      WHERE tn.name_class='scientific name'
                        AND t.taxon_id = tn.taxon_id
                        AND t.rank = 'species'
                        AND t.taxon_id in
                            (SELECT taxon_id
                             FROM sres.taxon
                             CONNECT BY taxon_id = prior parent_id
                             START WITH taxon_id IN
                             (SELECT ens.taxon_id
                              FROM dots.ExternalNaSequence ens, dots.Est e
                              WHERE e.na_sequence_id = ens.na_sequence_id))) orgs,
                     (SELECT 'Plasmodium falciparum' AS term, 1 as rank from dual
                      UNION
                      SELECT 'Plasmodium vivax' AS term, 2 as rank from dual
                      UNION
                      SELECT 'Plasmodium yoelii' AS term, 3 as rank from dual) partial_order
                  WHERE orgs.term = partial_order.term(+)
                  ORDER BY partial_order.rank
            </sql>
        </sqlQuery>

  </querySet>

</wdkModel>