<wdkModel>
    
    <paramSet name="sharedParams">
        
    <!------------------------------------------------------------------>
    <!-- Gene IDs -->  
    <!------------------------------------------------------------------>

        <datasetParam name="ds_gene_ids"
                     prompt="Gene ID input set"
            <help>input a comma delimited set of gene ids, or upload a file</help>
           <suggest sample="PF11_0344, PY01656, Pv092275"
                    default="PF11_0344"/>
        </datasetParam>


  <!------------------------------------------------------------------>
  <!--   -->
  <!------------------------------------------------------------------>
      <enumParam name="best_alignment_only"
                     prompt="Best alignments only"
                     multiPick="false">
        <help>
           <text>
             Select yes to return only those EST alignments that are the best alignment for the EST.  Many of the ESTs align at multiple positions in the genome.  Selecting yes will consider only those alignments that are the best for each EST
           </text>
        </help>
        <enumList>
          <enumValue term="Yes"
                 internal=   "1"/>
          <enumValue term="No"
                 internal=   "0,1"/>
        </enumList>
      </enumParam>


  <!------------------------------------------------------------------>
  <!--   -->
  <!------------------------------------------------------------------>
      <enumParam name="high_confidence_only"
                     prompt="Consistent alignments only"
                     multiPick="false">
        <help>
           <text>
             Select yes to return only those EST alignments that are consistent.  We define define consistent as having >= 95% identity (the majority have >= 99%) and aligning the EST sequence in a manner that is consistent with a gene model.  Ie, there can be gaps (representing introns) in the target genomic sequence but not in the EST query.
           </text>
        </help>
        <enumList>
          <enumValue term="No"
                 internal=   "0,1"/>
          <enumValue term="Yes"
                 internal=   "1"/>
        </enumList>
      </enumParam>

  <!------------------------------------------------------------------>
  <!--  -->  
  <!------------------------------------------------------------------>

        <stringParam name="min_percent_identity"
                     prompt="Percent identity >=">
            <help>You can specify a minimum percent identity of the alignment between the EST and genomic DNA.  We only store alignments with >= 90% identity</help>           
            <suggest default="90"/>
        </stringParam>

  <!------------------------------------------------------------------>
  <!--  -->  
  <!------------------------------------------------------------------>
        <stringParam name="min_percent_est_aligned"
                     prompt="Percent of EST bases aligned >=">
            <help>Enter the minimum percentage of bases in the EST sequence that are aligned to genomic DNA in this alignment.</help>
            <suggest default="20"
                          />
        </stringParam>

  <!------------------------------------------------------------------>
  <!--  -->  
  <!------------------------------------------------------------------>

        <stringParam name="bp_overlap_gte"
                     prompt="Base Overlap >="
                     substitute="yes">
            <help>Overlap of expressed sequence tag (EST) alignments with annotated genes is a useful approach to verify gene predictions. In general, the specificity of this evidence is proportional to the overlap length.</help>
            <suggest sample="(Example: 100)"
                     default="100"/>
        </stringParam>
  <!------------------------------------------------------------------>
  <!--  -->  
  <!------------------------------------------------------------------>

      <enumParam name="inNotIn"
                     prompt="EST"
                     multiPick="false">
        <help>
           <text>
             Select yes to return only those EST alignments that are consistent.  We define define consistent as having >= 95% identity (the majority have >= 99%) and aligning the EST sequence in a manner that is consistent with a gene model.  Ie, there can be gaps (representing introns) in the target genomic sequence but not in the EST query.
           </text>
        </help>
        <enumList>
          <enumValue term="does overlap with a gene"
                 internal=   "INTERSECT"/>
          <enumValue term="does not overlap with a gene"
                 internal=   "MINUS"/>
        </enumList>
      </enumParam>


  <!------------------------------------------------------------------>
  <!-- Universal, genomic and ORF BLAST -->  
  <!------------------------------------------------------------------>
      <enumParam name="BlastDatabaseType"
                     prompt="Target"
                     multiPick="false"
        <help>
           <text>
             The type of the subject database.
           </text>
        </help>
        <enumList>
          <enumValue term=" Choose one"
                 internal="Choose one"/>
          <enumValue term="Transcripts"
                 internal=   "Transcripts"/>
          <enumValue term="Translated Transcripts"
                 internal=   "Transcripts Translated"/>
          <enumValue term="Proteins"
                 internal=   "proteins"/>
          <enumValue term="Genome"
                 internal="genomic"/>
          <enumValue term="Translated Genome"
                 internal="genomic Translated"/>
          <enumValue term="ORF (Protein)"
                 internal="orfs"/>
          <enumValue term="EST"
                 internal="ESTs"/>
          <enumValue term="Translated EST"
                 internal="ESTs Translated"/>

        </enumList>
      </enumParam>

      <enumParam name="BlastDatabaseOrganism"
                     prompt="Organism"
                     multiPick="false">
        <help>
           <text>
             Organism(s) from which the sequences in the BLAST database originated
           </text>
        </help>
        <enumList>
          <enumValue term="P. berghei" includeProjects="ApiDB,PlasmoDB"
                 internal=   "Pberghei"/>
          <enumValue term="P. chabaudi" includeProjects="ApiDB,PlasmoDB"
                 internal=   "Pchabaudi"/>
          <enumValue term="P. falciparum" includeProjects="ApiDB,PlasmoDB"
                 internal=   "Pfalciparum"/>
          <enumValue term="P. falciparum mitocondrial" includeProjects="ApiDB,PlasmoDB"
                 internal=   "PfalciparumMito"/>
          <enumValue term="P. falciparum plastid" includeProjects="ApiDB,PlasmoDB"
                 internal=   "PfalciparumPlastid"/>
          <enumValue term="P. gallinaceum" includeProjects="ApiDB,PlasmoDB"
                 internal=   "Pgallinaceum"/>
          <enumValue term="P. knowlesi" includeProjects="ApiDB,PlasmoDB"
                 internal=   "Pknowlesi"/>
          <enumValue term="P. reichenowi" includeProjects="ApiDB,PlasmoDB"
                 internal=   "Preichenowi"/>
          <enumValue term="P. vivax" includeProjects="ApiDB,PlasmoDB"
                 internal=   "Pvivax"/>
          <enumValue term="P. yoelii" includeProjects="ApiDB,PlasmoDB"
                 internal=   "Pyoelii"/>
          <enumValue term="any" includeProjects="ApiDB,PlasmoDB"
                 internal=   "Plasmodium"/>

          <enumValue term="T. gondii ME49"  includeProjects="ApiDB,ToxoDB"
                 internal=   "Tgondii"/> 
          <enumValue term="T. gondi apicoplast" includeProjects="ApiDB,ToxoDB"
                 internal=   "TgondiiApicoplast"/>
          <enumValue term="T. gondii GT1"  includeProjects="ApiDB,ToxoDB"
                 internal=   "TgondiiGT1"/> 
          <enumValue term="T. gondii RH (chr Ia, Ib)"  includeProjects="ApiDB,ToxoDB"
                 internal=   "TgondiiRH"/> 
          <enumValue term="T. gondii VEG"  includeProjects="ApiDB,ToxoDB"
                 internal=   "TgondiiVeg"/> 

          <enumValue term="C. hominis" includeProjects="ApiDB,CryptoDB"
                 internal=   "Chominis"/> 
          <enumValue term="C. parvum" includeProjects="ApiDB,CryptoDB"
                 internal=   "Cparvum"/> 
          <enumValue term="C. parvum Chr6" includeProjects="ApiDB,CryptoDB"
                 internal=   "CparvumChr6"/> 
        </enumList>
      </enumParam>

      <enumParam name="BlastQueryType"
                     prompt="Query sequence type"
                     multiPick="false">
        <help>
           <text>
             The type of your query sequence
           </text>
        </help>
        <enumList>
          <enumValue term="DNA"
                 internal=   "dna"/>
          <enumValue term="Protein"
                 internal=   "protein"/>
        </enumList>
      </enumParam>

        <stringParam name="BlastQuerySequence"
                     prompt="Input Sequence"
                     length="4000">
            <help>BLAST Input Sequence</help>
            <suggest sample=""/>
        </stringParam>

      <enumParam name="-filter"
                    id="-filter"
                    prompt="Low complexity filter">
           <suggest default="yes"/>
        <help>
           <text>
             Set the low complexity filter. WUBLAST's default behavior is not to use this filter. NCBIBLAST's is to use it. When filter is set to 'yes' WUBLAST uses seg; NCBIBLAST uses dust for blastn, seg otherwise.
           </text>
        </help>
        <enumList>
          <enumValue term="yes"
                 internal=   "yes"/>
          <enumValue term="no"
                 internal=   "no"/>
        </enumList>
      </enumParam>

        <stringParam name="-e"
                     prompt="Expectation value">
            <help>Expected number of hits by chance</help>
            <suggest default="0.05"
                     sample="1e-10"/>
        </stringParam>

        <stringParam name="-v"
                     prompt="Maximum descriptions (V)">
            <help>Number of one-line descriptions to show</help>
            <suggest default="50"/>

        <stringParam name="-b"
                     prompt="Maximum alignments (B)">
            <help>Number of alignments to show</help>
            <suggest default="50"/>
        </stringParam>
    

  <!------------------------------------------------------------------>
  <!--  -->  
  <!------------------------------------------------------------------>

      <enumParam name="chromosome"
                     prompt="Chromosome"
                     multiPick="true">
        <help>
        </help>
        <enumList>
          <enumValue term="chromosome 1"
                 internal=   "'MAL1'"/>
          <enumValue term="chromosome 2"
                 internal=   "'MAL2'"/>
          <enumValue term="chromosome 3"
                 internal=   "'MAL3'"/>
          <enumValue term="chromosome 4"
                 internal=   "'MAL4'"/>
          <enumValue term="chromosome 5"
                 internal=   "'MAL5'"/>
          <enumValue term="chromosome 6"
                 internal=   "'MAL6'"/>
          <enumValue term="chromosome 7"
                 internal=   "'MAL7'"/>
          <enumValue term="chromosome 8"
                 internal=   "'MAL8'"/>
          <enumValue term="chromosome 9"
                 internal=   "'MAL9'"/>
          <enumValue term="chromosome 10"
                 internal=   "'MAL10'"/>
          <enumValue term="chromosome 11"
                 internal=   "'MAL11'"/>
          <enumValue term="chromosome 12"
                 internal=   "'MAL12'"/>
          <enumValue term="chromosome 13"
                 internal=   "'MAL13'"/>
          <enumValue term="chromosome 14"
                 internal=   "'MAL14'"/>
        </enumList>
      </enumParam>

      <enumParam name="chromosomeOptional"
                     prompt="P. falciparum Genomic Sequence"
                     multiPick="false"
                     default="choose one">
        <help>
           <text>
             Results will be sorted ascending or descending order
           </text>
        </help>
        <enumList>
          <enumValue term="choose one"
                 internal=   "'choose one'"/>
          <enumValue term="chromosome 1"
                 internal=   "'MAL1'"/>
          <enumValue term="chromosome 2"
                 internal=   "'MAL2'"/>
          <enumValue term="chromosome 3"
                 internal=   "'MAL3'"/>
          <enumValue term="chromosome 4"
                 internal=   "'MAL4'"/>
          <enumValue term="chromosome 5"
                 internal=   "'MAL5'"/>
          <enumValue term="chromosome 6"
                 internal=   "'MAL6'"/>
          <enumValue term="chromosome 7"
                 internal=   "'MAL7'"/>
          <enumValue term="chromosome 8"
                 internal=   "'MAL8'"/>
          <enumValue term="chromosome 9"
                 internal=   "'MAL9'"/>
          <enumValue term="chromosome 10"
                 internal=   "'MAL10'"/>
          <enumValue term="chromosome 11"
                 internal=   "'MAL11'"/>
          <enumValue term="chromosome 12"
                 internal=   "'MAL12'"/>
          <enumValue term="chromosome 13"
                 internal=   "'MAL13'"/>
          <enumValue term="chromosome 14"
                 internal=   "'MAL14'"/>
          <enumValue term="mitochondrial genome"
                 internal=   "'AJ276844'"/>
          <enumValue term="plastid IR-A"
                 internal=   "'X95275'"/>
          <enumValue term="plastid IR-B"
                 internal=   "'X95276'"/>
        </enumList>
      </enumParam>

    <!------------------------------------------------------------------>
    <!-- Sequence Id -->  
    <!------------------------------------------------------------------>

    <stringParam name="genomicSequence"
            prompt="Genomic sequence ID" 
            substitute="yes">
        <suggest includeProjects="CryptoDB"
            sample="(Examples: AAEL01000057, AAEE01000009, BX526834)"
            default="(Example: AAEE01000006)"/>
        <suggest includeProjects="ApiDB"
            sample="AAEL010000057, AAEE01000009, BX526834"
            default="AAEL01000057"/>
        <suggest includeProjects="ToxoDB"
            sample="Ia, VIIb, XI"
            default="Ia"/>
        <suggest includeProjects="PlasmoDB"
            sample="(Examples: MAL4, ctg_4094)"
            default="MAL4"/>     
        <help includeProjects="ApiDB">
          Enter an identifier for a genomic sequence. The IDs correspond to the accession numbers in the GenBank records supplied by the sequencing centers. Wild cards are permitted in this search, i.e. use AAEE* to ask for all &lt;i&gt; C.parvum &lt;/i&gt; contigs.
        <help includeProjects="CrptoDB">
            Enter an identifier for a genomic contig. The IDs
            correspond to the accession numbers in the GenBank records
            supplied by the sequencing centers. Contig ID's from
            &lt;i&gt; C. parvum &lt;/i&gt; whole genome sequencing
            project begin with 'AAEE' and contig ID's for &lt;i&gt;
            C. hominis &lt;/i&gt; begin with 'AAEL'. The &lt;i&gt;
            C. parvum &lt;/i&gt; Chromosome 6 independently sequenced
            at MRC-LMB  before the whole genome project was completed
            is 'BX526834 '. Wild cards are permitted in this search,
            i.e. use AAEE* to ask for all &lt;i&gt; C. parvum
            &lt;/i&gt; contigs.
        </help>
        <help includeProjects="PlasmoDB">
            Sequence IDs for &#60;i&#62; P. falciparum &#60;/i&#62; chromosomes are 'MAL1' through 'MAL14.'  Sequence IDs for &#60;i&#62; P. yoelii &#60;/i&#62; contigs begin with 'MALPY'.  Sequence IDs for &#60;i&#62; P. vivax &#60;/i&#62; contigs begin with 'ctg_'.  Wild cards are permitted in this search, i.e. use MALPY* to ask for all &#60;i&#62; P.vivax &#60;/i&#62; sequences.
        </help>
    </stringParam>    

        <stringParam name="start_point"
                     prompt="Start at"
                     substitute="yes">
            <help>Select the distance (in nucleotides) to the start</help>
            <suggest default="1"/>
        </stringParam>

        <stringParam name="end_point"
                     prompt="End Location (0 = end)"
                     substitute="yes">
            <help>Select the distance (in nucleotides) for the end location.  Note that 0 equals the end so you can get genes right up to the end of the sequence</help>
            <suggest default="0"/>
        </stringParam>

      <flatVocabParam name="libraryId"
                     queryRef="GeneVocabQueries.EstLibraries"
                     prompt="EST Library"
                     multiPick="true">
        <help>
           <text>
             Select a clone library.
           </text>
        </help>
      </flatVocabParam>

      <flatVocabParam name="snp_strain_a"
                     queryRef="GeneVocabQueries.SnpStrainA"
		     prompt="Reference"
                     multiPick="false">
        <help>
           <text>
             Choose a reference from the list of strains.  Strains below the ---------- were sequenced at low or specific coverage
           </text>
        </help>
      </flatVocabParam>

      <flatVocabParam name="snp_strain_b"
                     queryRef="GeneVocabQueries.SnpStrainB"
		     prompt="Comparator"
                     multiPick="false">
        <help>
           <text>
             Choose a comparator from the list to compare to your reference.  Strains below the ---------- were sequenced at low or specific coverage
           </text>
        </help>
      </flatVocabParam>

      <enumParam name="snp_strain_m"
		     prompt="Comparator(s)"
                     multiPick="true">
        <help>
           <text>
             Choose a comparator(s) from the list to compare to your reference.  Strains below the ---------- were sequenced at low or specific coverage
           </text>
        </help>
        <enumList>
          <enumValue term="Pf-7G8"
                 internal=   "'7G8'"/>
          <enumValue term="Pf-D10"
                 internal=   "'D10'"/>
          <enumValue term="Pf-DD2"
                 internal=   "'DD2'"/>
          <enumValue term="Pf-GHANA1"
                 internal=   "'GHANA1'"/>
          <enumValue term="Pf-HB3"
                 internal=   "'HB3'"/>
          <enumValue term="Pf-IT"
                 internal=   "'IT'"/>
          <enumValue term="P. reichenowi (vs. 3D7 only)"
                 internal=   "'Preich'"/>
          <enumValue term="Pf-3D7"
                 internal=   "'3D7'"/>
          <enumValue term="-----------"
                 internal=   "'foobar'"/>
          <enumValue term="Pf-106"
                 internal=   "'106'"/>
          <enumValue term="Pf-106/1"
                 internal=   "'106/1'"/>
          <enumValue term="Pf-D6"
                 internal=   "'D6'"/>
          <enumValue term="Pf-FCB"
                 internal=   "'FCB'"/>
          <enumValue term="Pf-FCC-2"
                 internal=   "'FCC-2'"/>
          <enumValue term="Pf-FCR3"
                 internal=   "'FCR3'"/>
          <enumValue term="Pf-K1"
                 internal=   "'K1'"/>
          <enumValue term="Pf-Malayan Camp"
                 internal=   "'Malayan Camp'"/>
          <enumValue term="Pf-RO33"
                 internal=   "'RO33'"/>
          <enumValue term="Pf-Santa Lucia"
                 internal=   "'Santa Lucia'"/>
          <enumValue term="Pf-Senegal 31.01"
                 internal=   "'Senegal 31.01'"/>
          <enumValue term="Pf-Senegal 34.04"
                 internal=   "'Senegal 34.04'"/>
          <enumValue term="Pf-Senegal 35.04"
                 internal=   "'Senegal 35.04'"/>
          <enumValue term="Pf-Senegal 51.02"
                 internal=   "'Senegal 51.02'"/>
          <enumValue term="Pf-VS-1"
                 internal=   "'VS-1'"/>
        </enumList>
      </enumParam>

  <!------------------------------------------------------------------>
  <!-- Motif search -->
  <!------------------------------------------------------------------>

        <stringParam name="motif_expression"
                     prompt="Pattern">
            <help>Enter a Perl regular expression describing the desired motif.  Example: 'CC6+RK' searches for two consecutive cysteine residues followed by a stretch of hydrophobic amino acids followed by the aminoacids arginine and lysine.</help>
            <suggest sample="(Example: CC6+RK)"
                     default="CC6+RK"/>
        </stringParam>


    <!------------------------------------------------------------------>
    <!-- History -->  
    <!------------------------------------------------------------------>

        <historyParam name="historyId"
              prompt="History ID">
              <help>The number in the left column of My Query History</help>
        </historyParam>
        
    </paramSet>

  <!--======================================================================-->
  <!-- General Vocab queries  -->
  <!--======================================================================-->

  <querySet name="GeneralVocabQueries">


        <sqlQuery name="SnpStrainA">
          <column name="internal"/>
          <column name="term"/>
          <sql>
	    select distinct strain_a as internal, CASE WHEN strain_a = 'Preich' THEN 'P. reichenowi (vs. 3D7 only)' ELSE 'Pf-' || strain_a END as term, 1 as ord
	    from apidb.snpsummary
            where strain_a in ('3D7', 'DD2', 'GHANA1', 'HB3', 'IT', '7G8', 'D10')
            union
	    select distinct strain_b as internal, CASE WHEN strain_b = 'Preich' THEN 'P. reichenowi (vs. 3D7 only)' ELSE 'Pf-' || strain_b END as term, 1 as ord
	    from apidb.snpsummary
            where strain_b in ('3D7', 'DD2', 'GHANA1', 'HB3', 'IT', '7G8', 'D10')
            union
            select distinct strain_a as internal, CASE WHEN strain_a = 'Preich' THEN 'P. reichenowi (vs. 3D7 only)' ELSE 'Pf-' || strain_a END as term, 3 as ord
	    from apidb.snpsummary
            where strain_a not in ('3D7', 'DD2', 'GHANA1', 'HB3', 'IT', '7G8', 'D10', 'Preich')
            and strain_a not like '%-NIH'
            union
	    select distinct strain_b as internal, CASE WHEN strain_b = 'Preich' THEN 'P. reichenowi (vs. 3D7 only)' ELSE 'Pf-' || strain_b END as term, 3 as ord
	    from apidb.snpsummary
            where strain_b not in ('3D7', 'DD2', 'GHANA1', 'HB3', 'IT', '7G8', 'D10', 'Preich')
            and strain_b not like '%-NIH'
            union
            select 'foobar' as internal, '-----------' as term, 2 as ord from dual
	    order by ord,internal
          </sql>
        </sqlQuery>

        <sqlQuery name="SnpStrainB">
          <column name="internal"/>
          <column name="term"/>
          <sql>
	    select distinct strain_a as internal, CASE WHEN strain_a = 'Preich' THEN 'P. reichenowi (vs. 3D7 only)' ELSE 'Pf-' || strain_a END as term, 1 as ord
	    from apidb.snpsummary
            where strain_a in ('Preich', 'DD2', 'GHANA1', 'HB3', 'IT', '7G8', 'D10')
            union
	    select distinct strain_b as internal, CASE WHEN strain_b = 'Preich' THEN 'P. reichenowi (vs. 3D7 only)' ELSE 'Pf-' || strain_b END as term, 1 as ord
	    from apidb.snpsummary
            where strain_b in ('Preich', 'DD2', 'GHANA1', 'HB3', 'IT', '7G8', 'D10')
            union
            select distinct strain_a as internal, CASE WHEN strain_a = 'Preich' THEN 'P. reichenowi (vs. 3D7 only)' ELSE 'Pf-' || strain_a END as term, 3 as ord
	    from apidb.snpsummary
            where strain_a not in ('3D7', 'DD2', 'GHANA1', 'HB3', 'IT', '7G8', 'D10', 'Preich')
            and strain_a not like '%-NIH'
            union
	    select distinct strain_b as internal, CASE WHEN strain_b = 'Preich' THEN 'P. reichenowi (vs. 3D7 only)' ELSE 'Pf-' || strain_b END as term, 3 as ord
	    from apidb.snpsummary
            where strain_b not in ('3D7', 'DD2', 'GHANA1', 'HB3', 'IT', '7G8', 'D10', 'Preich')
            and strain_b not like '%-NIH'
            union
            select 'foobar' as internal, '-----------' as term, 2 as ord from dual
	    order by ord,internal
          </sql>
        </sqlQuery>

        <sqlQuery name="EstLibraries">
            <column name="internal"/>
            <column name="term"/>
            <sql>
                SELECT REPLACE(dbest_name, ',', ' - ') AS term,
                       library_id AS internal
                FROM dots.library
                ORDER BY dbest_name
            </sql>
        </sqlQuery>


  </querySet>

    
</wdkModel>
