<wdkModel>
    
    <paramSet name="generalParams">
        
  <!------------------------------------------------------------------>
  <!-- Organism -->  
  <!------------------------------------------------------------------>

      <flatVocabParam name="organism"
                     queryRef="GeneralVocabQueries.OrganismWithGenes"
                     prompt="Organism"
                     multiPick="true">
        <help>
           <text>
             Select one or more organisms.
           </text>
        </help>
      </flatVocabParam>

      <flatVocabParam name="organism_with_sequences"
                     queryRef="GeneralVocabQueries.OrganismWithSequences"
                     prompt="Organism"
                     multiPick="true">
        <help>
           <text>
             Select one or more organisms.
           </text>
        </help>
      </flatVocabParam>

      <flatVocabParam name="organism_with_ests"
                     queryRef="GeneralVocabQueries.OrganismWithEsts"
                     prompt="Organism"
                     multiPick="true">
        <help>
           <text>
             Select one or more organisms.
           </text>
        </help>
      </flatVocabParam>

      <flatVocabParam name="species_name"
                     queryRef="GeneralVocabQueries.SpeciesName"
                     prompt="Plasmodium species"
                     multiPick="true">
        <help>
           <text>
             Select one or more organisms.
           </text>
        </help>
      </flatVocabParam>


  <!------------------------------------------------------------------>
  <!-- Universal BLAST -->  
  <!------------------------------------------------------------------>

      <enumParam name="BlastDatabaseOrganism"
                     prompt="Organism"
                     multiPick="false">
        <help>
           <text>
             Organism(s) from which the sequences in the BLAST database originated
           </text>
        </help>
        <enumList>
          <enumValue term="P. berghei" includeProjects="ApiDB,PlasmoDB"
                 internal=   "Pberghei"/>
          <enumValue term="P. chabaudi" includeProjects="ApiDB,PlasmoDB"
                 internal=   "Pchabaudi"/>
          <enumValue term="P. falciparum" includeProjects="ApiDB,PlasmoDB"
                 internal=   "Pfalciparum"/>
          <enumValue term="P. falciparum mitocondrial" includeProjects="ApiDB,PlasmoDB"
                 internal=   "PfalciparumMito"/>
          <enumValue term="P. falciparum plastid" includeProjects="ApiDB,PlasmoDB"
                 internal=   "PfalciparumPlastid"/>
          <enumValue term="P. gallinaceum" includeProjects="ApiDB,PlasmoDB"
                 internal=   "Pgallinaceum"/>
          <enumValue term="P. knowlesi" includeProjects="ApiDB,PlasmoDB"
                 internal=   "Pknowlesi"/>
          <enumValue term="P. reichenowi" includeProjects="ApiDB,PlasmoDB"
                 internal=   "Preichenowi"/>
          <enumValue term="P. vivax" includeProjects="ApiDB,PlasmoDB"
                 internal=   "Pvivax"/>
          <enumValue term="P. yoelii" includeProjects="ApiDB,PlasmoDB"
                 internal=   "Pyoelii"/>
          <enumValue term="any" includeProjects="ApiDB,PlasmoDB"
                 internal=   "Plasmodium"/>

          <enumValue term="T. gondii ME49"  includeProjects="ApiDB,ToxoDB"
                 internal=   "Tgondii"/> 
          <enumValue term="T. gondi apicoplast" includeProjects="ApiDB,ToxoDB"
                 internal=   "TgondiiApicoplast"/>
          <enumValue term="T. gondii GT1"  includeProjects="ApiDB,ToxoDB"
                 internal=   "TgondiiGT1"/> 
          <enumValue term="T. gondii RH (chr Ia, Ib)"  includeProjects="ApiDB,ToxoDB"
                 internal=   "TgondiiRH"/> 
          <enumValue term="T. gondii VEG"  includeProjects="ApiDB,ToxoDB"
                 internal=   "TgondiiVeg"/> 

          <enumValue term="C. hominis" includeProjects="ApiDB,CryptoDB"
                 internal=   "Chominis"/> 
          <enumValue term="C. parvum" includeProjects="ApiDB,CryptoDB"
                 internal=   "Cparvum"/> 
          <enumValue term="C. parvum Chr6" includeProjects="ApiDB,CryptoDB"
                 internal=   "CparvumChr6"/> 
        </enumList>
      </enumParam>

      <enumParam name="BlastQueryType"
                     prompt="Query sequence type"
                     multiPick="false">
        <help>
           <text>
             The type of your query sequence (eg. DNA, protein)
           </text>
        </help>
        <enumList>
          <enumValue term="DNA"
                 internal=   "dna"/>
          <enumValue term="Protein"
                 internal=   "protein"/>
        </enumList>
      </enumParam>

        <stringParam name="BlastQuerySequence"
                     prompt="Input Sequence"
                     length="4000">
            <help>BLAST Input Sequence</help>
            <suggest sample=""/>
        </stringParam>

      <enumParam name="-filter"
                    id="-filter"
                    prompt="Low complexity filter">
           <suggest default="yes"/>
        <help>
           <text>
             Set the low complexity filter. WUBLAST's default behavior is not to use this filter. NCBIBLAST's is to use it. When filter is set to 'yes' WUBLAST uses seg; NCBIBLAST uses dust for blastn, seg otherwise.
           </text>
        </help>
        <enumList>
          <enumValue term="yes"
                 internal=   "yes"/>
          <enumValue term="no"
                 internal=   "no"/>
        </enumList>
      </enumParam>

        <stringParam name="-e"
                     prompt="Expectation value">
            <help>Expected number of hits by chance</help>
            <suggest default="0.05"
                     sample="1e-10"/>
        </stringParam>

        <stringParam name="-v"
                     prompt="Maximum descriptions (V)">
            <help>Number of one-line descriptions to show</help>
            <suggest default="50"/>

        <stringParam name="-b"
                     prompt="Maximum alignments (B)">
            <help>Number of alignments to show</help>
            <suggest default="50"/>
        </stringParam>
    
    <!------------------------------------------------------------------>
    <!-- History -->  
    <!------------------------------------------------------------------>

        <historyParam name="historyId"
              prompt="History ID">
              <help>The number in the left column of My Query History</help>
        </historyParam>
        
    </paramSet>

  <!--===========================================================================-->
  <!-- General Vocab queries  -->
  <!--===========================================================================-->

  <querySet name="GeneralVocabQueries">

    <!------------------------------------------------------------------>
    <!-- Organism -->  
    <!------------------------------------------------------------------>

        <sqlQuery name="OrganismWithGenes">
            <column name="internal"/>
            <column name="term"/>
             <sql>
                  SELECT orgs.term, (select apidb.tab_to_string(CAST(COLLECT(trim(to_char(taxon_id))) AS apidb.varchartab), ', ') as internal
                    FROM sres.taxon
                    CONNECT BY prior taxon_id = parent_id
                    START WITH taxon_id = orgs.internal_tax) as internal
                FROM (SELECT tn.name AS term, t.taxon_id AS internal_tax
                      FROM sres.TaxonName tn, sres.taxon t
                      WHERE tn.name_class='scientific name'
                      AND t.taxon_id = tn.taxon_id
                        AND t.rank = 'species' 
                        AND t.taxon_id in
                            (SELECT taxon_id
                             FROM sres.taxon
                             CONNECT BY taxon_id = prior parent_id
                             START WITH taxon_id IN
                             (SELECT ens.taxon_id
                              FROM dots.ExternalNaSequence ens, dots.GeneFeature gf
                              WHERE gf.na_sequence_id = ens.na_sequence_id))) orgs,
                     (SELECT 'Plasmodium falciparum' AS term, 1 as rank from dual
                      UNION
                      SELECT 'Plasmodium vivax' AS term, 2 as rank from dual
                      UNION
                      SELECT 'Plasmodium yoelii' AS term, 3 as rank from dual) partial_order
                  WHERE orgs.term = partial_order.term(+)
                  ORDER BY partial_order.rank
            </sql>
        </sqlQuery>

        <sqlQuery name="OrganismWithSequences">
            <column name="internal"/>
            <column name="term"/>
             <sql>
                SELECT orgs.term, orgs.internal
                FROM (SELECT tn.name AS term, t.taxon_id AS internal
                      FROM sres.TaxonName tn, sres.taxon t
                      WHERE tn.name_class='scientific name'
                        AND t.taxon_id = tn.taxon_id
                        AND t.rank = 'species'
                        AND t.taxon_id in
                            (SELECT taxon_id
                             FROM sres.taxon
                             CONNECT BY taxon_id = prior parent_id
                             START WITH taxon_id IN
                             (SELECT ens.taxon_id
                              FROM dots.ExternalNaSequence ens))) orgs,
                     (SELECT 'Plasmodium falciparum' AS term, 1 as rank from dual
                      UNION
                      SELECT 'Plasmodium vivax' AS term, 2 as rank from dual
                      UNION
                      SELECT 'Plasmodium yoelii' AS term, 3 as rank from dual) partial_order
                  WHERE orgs.term = partial_order.term(+)
                  ORDER BY partial_order.rank
            </sql>
        </sqlQuery>

        <sqlQuery name="OrganismWithEsts">
            <column name="internal"/>
            <column name="term"/>
             <sql>
                SELECT orgs.term, orgs.internal
                FROM (SELECT tn.name AS term, t.taxon_id AS internal
                      FROM sres.TaxonName tn, sres.taxon t
                      WHERE tn.name_class='scientific name'
                        AND t.taxon_id = tn.taxon_id
                        AND t.rank = 'species'
                        AND t.taxon_id in
                            (SELECT taxon_id
                             FROM sres.taxon
                             CONNECT BY taxon_id = prior parent_id
                             START WITH taxon_id IN
                             (SELECT ens.taxon_id
                              FROM dots.ExternalNaSequence ens, dots.Est e
                              WHERE e.na_sequence_id = ens.na_sequence_id))) orgs,
                     (SELECT 'Plasmodium falciparum' AS term, 1 as rank from dual
                      UNION
                      SELECT 'Plasmodium vivax' AS term, 2 as rank from dual
                      UNION
                      SELECT 'Plasmodium yoelii' AS term, 3 as rank from dual) partial_order
                  WHERE orgs.term = partial_order.term(+)
                  ORDER BY partial_order.rank
            </sql>
        </sqlQuery>

        <sqlQuery name="SpeciesName">
            <column name="internal"/>
            <column name="term"/>
             <sql>
                SELECT orgs.term, orgs.internal
                FROM (SELECT tn.name AS term, tn.name AS internal
                      FROM sres.TaxonName tn, sres.taxon t
                      WHERE tn.name_class='scientific name'
                        AND t.taxon_id = tn.taxon_id
                        AND t.rank = 'species'
                        AND t.taxon_id in
                            (SELECT taxon_id
                             FROM sres.taxon
                             CONNECT BY taxon_id = prior parent_id
                             START WITH taxon_id IN
                             (SELECT ens.taxon_id
                              FROM dots.ExternalNaSequence ens, dots.GeneFeature gf
                              WHERE gf.na_sequence_id = ens.na_sequence_id))) orgs,
                     (SELECT 'Plasmodium falciparum' AS term, 1 as rank from dual
                      UNION
                      SELECT 'Plasmodium vivax' AS term, 2 as rank from dual
                      UNION
                      SELECT 'Plasmodium yoelii' AS term, 3 as rank from dual) partial_order
                  WHERE orgs.term = partial_order.term(+)
                  ORDER BY partial_order.rank
            </sql>
        </sqlQuery>

  </querySet>

    
</wdkModel>
