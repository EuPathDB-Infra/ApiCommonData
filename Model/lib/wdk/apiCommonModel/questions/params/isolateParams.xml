<wdkModel>

  <!-- notes

     - should ms_assay param be a controlled vocab pulled from the database?

  -->

  <paramSet name="isolateParams">

    <!--++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!-- ID -->
    <!--++++++++++++++++++++++++++++++++++++++++++++++++-->
        <stringParam name="isolate_id"
                     prompt="Isolate ID">
        <help>
             Enter an Isolate ID.  Wildcards (*) are allowed.
        </help>
            <suggest includeProjects="CryptoDB"
                     sample="AF527841, DQ1145002, DQ115*"
                     default="AF527841"/>
        </stringParam>

        <stringParam name="author"
		                 prompt="Author">
						<help> 
						  Enter an Author name.  Wildcards (*) are allowed.  
						</help> 
						
						<suggest includeProjects="CryptoDB" sample="Xiao*" default="Xiao*"/> 
				</stringParam>

        <flatVocabParam name="isolate_organism"
				         queryRef="organismIQ.withIsolates"
								prompt="Organism"
								multiPick="true"
								quote="false">
					<useTermOnly value="true" includeProjects="CryptoDB"/>
			  </flatVocabParam>

        <flatVocabParam name="specific_host"
				         queryRef="hostVQ.withIsolates"
								prompt="Host Name"
								multiPick="true"
								quote="false">
					<useTermOnly value="true" includeProjects="CryptoDB"/>
			  </flatVocabParam>

        <flatVocabParam name="isolation_source"
				         queryRef="isolationSourceVQ.withIsolates"
								prompt="Isolation Source"
								multiPick="true"
								quote="false">
					<useTermOnly value="true" includeProjects="CryptoDB"/>
			  </flatVocabParam>

        <flatVocabParam name="product"
				        queryRef="productVQ.withIsolates"
								prompt="Product Name"
								multiPick="true"
								quote="false">
					<useTermOnly value="true" includeProjects="CryptoDB"/>
			  </flatVocabParam>

        <flatVocabParam name="study"
				        queryRef="studyVQ.withIsolates"
								prompt="Study Name"
								multiPick="true"
								quote="false">
					<useTermOnly value="true" includeProjects="CryptoDB"/>
			  </flatVocabParam>

        <flatVocabParam name="country"
				        queryRef="countryVQ.withIsolates"
								prompt="Country Name"
								multiPick="true"
								quote="false">
					<useTermOnly value="true" includeProjects="CryptoDB"/>
			  </flatVocabParam>

  </paramSet>

  <querySet name="organismIQ">
			<sqlQuery name="withIsolates" excludeProjects="ApiDB">
					<column name="internal"/>
					<column name="term"/>
					<sql>
					<![CDATA[
					SELECT distinct src.organism AS term,
					       src.organism      AS internal
					FROM   DoTS.Source src,
					       DoTS.ExternalNASequence etn,
					       SRes.ExternalDatabaseRelease edr,
								 SRes.ExternalDatabase edb
					WHERE  edr.external_database_id = edb.external_database_id
					   AND edr.external_database_release_id = etn.external_database_release_id
						 AND edb.name = 'Isolates Data Test5'
						 AND edr.version = '2007-11-14'
						 AND src.na_sequence_id = etn.na_sequence_id
						 AND src.organism is not null
					]]>
					</sql>
			</sqlQuery>
	 </querySet>

  <querySet name="hostVQ">
			<sqlQuery name="withIsolates" excludeProjects="ApiDB">
					<column name="internal"/>
					<column name="term"/>
					<sql>
					<![CDATA[
					SELECT distinct src.specific_host AS term,
					       src.specific_host      AS internal
					FROM   DoTS.Source src,
					       DoTS.ExternalNASequence etn,
					       SRes.ExternalDatabaseRelease edr,
								 SRes.ExternalDatabase edb
					WHERE  src.specific_host is not null
					   AND edr.external_database_id = edb.external_database_id
					   AND edr.external_database_release_id = etn.external_database_release_id
						 AND edb.name = 'Isolates Data Test5'
						 AND edr.version = '2007-11-14'
						 AND src.na_sequence_id = etn.na_sequence_id
					]]>
					</sql>
			</sqlQuery>
	</querySet>

  <querySet name="isolationSourceVQ">
			<sqlQuery name="withIsolates" excludeProjects="ApiDB">
					<column name="internal"/>
					<column name="term"/>
					<sql>
					<![CDATA[
					SELECT distinct src.specimen_voucher AS term,
					       src.specimen_voucher      AS internal
					FROM   DoTS.Source src,
					       DoTS.ExternalNASequence etn,
					       SRes.ExternalDatabaseRelease edr,
								 SRes.ExternalDatabase edb
					WHERE  src.specimen_voucher is not null
					   AND edr.external_database_id = edb.external_database_id
					   AND edr.external_database_release_id = etn.external_database_release_id
						 AND edb.name = 'Isolates Data Test5'
						 AND edr.version = '2007-11-14'
						 AND src.na_sequence_id = etn.na_sequence_id
					]]>
					</sql>
			</sqlQuery>
	</querySet>

  <querySet name="productVQ">
			<sqlQuery name="withIsolates" excludeProjects="ApiDB">
					<column name="internal"/>
					<column name="term"/>
					<sql>
					<![CDATA[
					SELECT distinct trp.product AS term,
					trp.product      AS internal
					FROM DoTS.Transcript trp
					WHERE 
					 trp.product is not null and
					 trp.row_alg_invocation_id > 1000
					]]>
					</sql>
			</sqlQuery>
	 </querySet>

  <querySet name="studyVQ">
			<sqlQuery name="withIsolates" excludeProjects="ApiDB">
					<column name="internal"/>
					<column name="term"/>
					<sql>
					<![CDATA[
					SELECT distinct ref.title AS term,
					ref.title      AS internal
					FROM SRES.Reference ref
					WHERE 
					 ref.row_alg_invocation_id > 1000
					]]>
					</sql>
			</sqlQuery>
	 </querySet>

  <querySet name="countryVQ">
			<sqlQuery name="withIsolates" excludeProjects="ApiDB">
					<column name="internal"/>
					<column name="term"/>
					<sql>
					<![CDATA[
					SELECT distinct iso.country AS term,
					       iso.country AS internal
					FROM   DoTS.Source src,
					       ApiDB.IsolateSource iso,
					       DoTS.ExternalNASequence etn,
					       SRes.ExternalDatabaseRelease edr,
								 SRes.ExternalDatabase edb
					WHERE  edr.external_database_id = edb.external_database_id
					   AND edr.external_database_release_id = etn.external_database_release_id
						 AND edb.name = 'Isolates Data Test5'
						 AND edr.version = '2007-11-14'
						 AND src.na_sequence_id = etn.na_sequence_id
						 AND iso.na_sequence_id = etn.na_sequence_id
					]]>
					</sql>
			</sqlQuery>
	</querySet>

</wdkModel>

