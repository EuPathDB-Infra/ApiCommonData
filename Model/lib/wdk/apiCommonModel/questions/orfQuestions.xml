<wdkModel>

  <questionSet name="OrfQuestions"
               displayName="Search Orfs">

    <!--++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!-- Location  -->
    <!--++++++++++++++++++++++++++++++++++++++++++++++++-->

    <question name="OrfsByLocation"
              category="Genomic Position"
              displayName="Chromosomal Location"
              queryRef="OrfIds.OrfsByLocation"
              recordClassRef="OrfRecordClasses.OrfRecordClass">

      <attributesList 
             summary="formatted_organism,orf_location_text,length"
             sorting="formatted_organism asc,orf_location_text asc"
      />

      <summary>
          Find Orfs that are located in a specified genomic region.
      </summary>

      <description>
          <![CDATA[
            <p>Find Orfs that are located in a specified genomic region.</p>
            <p>Enter the ID of a genomic sequence, start and end locations on that sequence and the minimum length (in amino acids) of the ORF.</p>
          ]]>
      </description>

    </question>


    <!--++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!-- Id -->
    <!--++++++++++++++++++++++++++++++++++++++++++++++++-->

    <question name="OrfByOrfId" 
              displayName="Orfs by ID"
              queryRef="OrfIds.OrfByOrfId" 
              recordClassRef="OrfRecordClasses.OrfRecordClass">

             <attributesList 
               summary="formatted_organism,orf_location_text,length"
               sorting="formatted_organism asc, orf_location_text asc"
             />
             <summary>
             Find ORFs by ID.
             </summary>
             <description>
             Find open reading frames (ORFs) by ID.  The IDs are generated based on the order of the ORF on the
             genomic sequence.  The ORF IDs are not reliable from release to release.
             </description>
    </question>


    <!--++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!-- Mass Spec -->
    <!--++++++++++++++++++++++++++++++++++++++++++++++++-->

    <question name="OrfsByMassSpec" includeProjects="CryptoDB,ToxoDB,ApiDB" 
              category="Other Attributes"
              displayName="Mass Spec. Evidence"
              queryRef="OrfIds.OrfsByMassSpec" 
              recordClassRef="OrfRecordClasses.OrfRecordClass">

          <attributesList 
              summary="formatted_organism,orf_location_text,sum_sequence_count,sum_spectrum_count"
              sorting="formatted_organism asc,sum_sequence_count desc,sum_spectrum_count desc"
          />

              <summary>
             Find open reading frames that have evidence of expression 
             based on peptides identified in sporozoites by MS/MS analysis.
              </summary>

              <description includeProjects="CryptoDB">
              <![CDATA[
             Find <i>Cryptosporidium</i> open reading frames that have evidence of expression 
             based on peptides identified by MS/MS analysis in an sporozoite excystation mixture. Some contaiminating oocyst proteins will also be in the mixture.<p>
            See the related <a href="showQuestion.do?questionFullName=GeneQuestions.GenesByMassSpec"><b>Genes with Mass Spec. Evidence</b></a> query to find gene models which have mapped MS/MS peptides.  NOTE: This query only returns ORFs that contain peptides that could not be mapped onto an annotated gene model overlapping with the ORF.
            <p>
             <sup>&#182;</sup>
   <%-- description by J. Wastling --%>
<i> S.J. Sanderson, D. Xia, H. Prieto, J. Yates, M. Heiges. J. Kissinger & J.M. Wastling (submitted). <b>Contact: Jonathan Wastling for details (<a href="mailto:j.wastling@liv.ac.uk">j.wastling@liv.ac.uk</a>)</b></i>.
<br>
Mass spectrometry data were obtained from two-dimensional gel 
electrophoretic protein separations, one-dimensional gel LC-MS/MS and 
MudPIT analysis of a sporozoite/oocyst excystation mixture of 
<i>Cryptosporidium parvum</i>.  A total of approximately 3,500 protein 
hits were obtained resulting in 1,252 non-redundant protein identifications.  
In addition a further 100 hits were obtained to sequences which matched a 
predicted open reading frame, but for which no gene model currently exists.  
In total these protein identifications represent nearly one third of the 
entire predicted proteome of <i>C. parvum</i>, although it is unlikely 
that the entire proteome from all life-stages will be expressed at any 
one time.
             ]]>
             </description>

              <description includeProjects="ToxoDB">
              <![CDATA[
             <p>
             Find <i>Toxoplasma</i> ORFs that have evidence of protein expression based on Mass Spec analyses.
             <p>See the related <a href="showQuestion.do?questionFullName=GeneQuestions.GenesByMassSpec"><b>Genes with Mass Spec. Evidence</b></a> query to find gene models which have mapped MS/MS peptides.  NOTE: This query only returns ORFs that contain peptides that could not be mapped onto an annotated gene model overlapping with the ORF.
             <p>
             <sup>1</sup> <i>Proteomics data from JM Wastling, SJ Sanderson, D Xia, J Yates, H Prieto.</i> Contact: Jonathan Wastling for details (j.wastling@liv.ac.uk)<br>
             Mass spectrometry data were obtained from one-dimensional gel LC-MS/MS and MudPIT analysis of Toxoplasma gondii tachyzoites. 6,546 protein hits were obtained resulting in 2217 non-redundant protein identifications. A further 318 hits were obtained to sequences which matched 226 predicted open reading frames for which no gene model currently exists.  Additionally, 163 gene predictions were hit that did not have an overlapping gene model to which at least 50% of the peptides could be mapped.  In total these protein identifications from one stage represent nearly one third of the entire predicted proteome of T. gondii.
             <p>
             <sup>2</sup><i>Hu K, Johnson J, Florens L, Fraunholz M, Suravajjala S, 
	     DiLullo C, Yates JR, Roos DS, Murray JM. (2006) 
	     Cytoskeletal Components of an Invasion Machine - The Apical Complex of Toxoplasma gondii. 
	     PLoS Pathog <b>2</b>:121-138.</i><br>
             1,887 protein hits were obtained resulting in 1,166 non-redundant protein identifications. A further 498 hits were obtained to sequences which matched 446 predicted open reading frames for which no gene model currently exists.  
             <p><p>
             Taken together, these two datasets result in 8,433 protein hits to 2,436 non-redundant Toxoplasma proteins and 816 hits to 634 non-redundant ORFs that contain peptides that couldn't be mapped to annotated proteins. 
             With the additional evidence from the predicted gene models, nearly 40% of the predicted proteome from T. gondii is represented.  The data provide evidence that often corroborates the annotated gene models and in some instances the peptides mapping to ORFs and predicted gene models provide evidence for alternatives to the current annotations.
             ]]>
             </description>

	<dynamicAttributes>
	     <columnAttribute name="sum_sequence_count" displayName="Number of Peptide Sequences" align="center"/>
	     <columnAttribute name="sum_spectrum_count" displayName="Number of Spectra" align="center"/>
	</dynamicAttributes>
    </question>


    <!--++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!-- Motif Search  -->
    <!--++++++++++++++++++++++++++++++++++++++++++++++++-->


    <question name="OrfsByMotifSearch"
         displayName="ORFs by Protein Motif Search"
         category="Text Search"
         queryRef="OrfIds.OrfsByMotifSearch"
         recordClassRef="OrfRecordClasses.OrfRecordClass">

      <attributesList
         summary="organism,Locations,MatchCount,Sequence"
         sorting="orgmanism asc"
      />

         <description>
           <![CDATA[

         Find genes whose protein product contains a motif pattern that you specify.<p>

           Specify the pattern with a (Perl style) "regular expression".
           (Regular expressions are more powerful than PROSITE patterns.) For
           a description of how to create regular expressions, please see 
           the  <a href="regexp.jsp">Regular Expression
           Tutorial</a>.
            <br><br>
             The following codes can be used to represent classes of amino acids.
        <table border columns=3>
                   <TR>
                      <TD><B>AA property</B>
                      </TD>
                      <TD><B>Amino acids</B>
                      </TD>
                      <TD><B>Code</B>
                      </TD>
                   </TR>

                   <TR>
                      <TD>
                      <B>Acidic</B>
                      </TD>
                      <TD><B>DE</B>
                      </TD>
                      <TD><B>0</B>
                      </TD>
                   </TR>
                   <TR>
                      <TD><B>Alcohol</B>
                      </TD>
                      <TD><B>ST</B>
                      </TD>
                      <TD><B>1</B>
                      </TD>
                   </TR>
                   <TR>
                      <TD><B>Aliphatic</B>
                      </TD>
                      <TD><B>ILV</B>
                      </TD>
                      <TD><B>2</B>
                      </TD>
                   </TR>
                   <TR>
                      <TD><B>Aromatic</B>
                      </TD>
                      <TD><B>FHWY</B>
                      </TD>
                      <TD><B>3</B>
                      </TD>
                   </TR>
                   <TR>
                      <TD><B>Basic</B>
                      </TD>
                      <TD><B>KRH</B>
                      </TD>
                      <TD><B>4</B>
                      </TD>
                   </TR>
                   <TR>
                      <TD><B>Charged</B>
                      </TD>
                      <TD><B>DEHKR</B>
                      </TD>
                      <TD><B>5</B>
                      </TD>
                   </TR>
                   <TR>
                      <TD><B>Hydrophobic</B>
                      </TD>
                      <TD><B>AVILMFYW</B>
                      </TD>
                      <TD><B>6</B>
                      </TD>
                   </TR>
                   <TR>
                      <TD><B>Hydrophilic</B>
                      </TD>
                      <TD><B>KRHDENQ</B>
                      </TD>
                      <TD><B>7</B>
                      </TD>
                   </TR>
                   <TR>
                      <TD><B>Polar</B>
                      </TD>
                      <TD><B>CDEHKNQRST</B>
                      </TD>
                      <TD><B>8</B>
                      </TD>
                   </TR>
                   <TR>
                      <TD><B>Small</B>
                      </TD>
                      <TD><B>ACDGNPSTV</B>
                      </TD>
                      <TD><B>9</B>
                      </TD>
                   </TR>
                   <TR>
                      <TD><B>Tiny</B>
                      </TD>
                      <TD><B>AGS</B>
                      </TD>
                      <TD><B>B</B>
                      </TD>
                   </TR>
                   <TR>
                      <TD><B>Turnlike</B>
                      </TD>
                      <TD><B>ACDEGHKNQRST</B>
                      </TD>
                      <TD><B>Z</B>
                      </TD>
                   </TR>
                   <TR>
                      <TD><B>Any</B>
                      </TD>
                      <TD><b>ACDEFGHIKLM<br>
                             NPQRSTVWY</b>
                      </TD>
                      <TD><B>.</B>
                      </TD>
                   </TR>
                   </table>

          ]]>
         </description>
         <dynamicAttributes>
           <columnAttribute name="Locations" inReportMaker="false"/>
           <columnAttribute name="MatchCount" displayName="Match Count"
                            inReportMaker="false"/>
           <columnAttribute name="Sequence" inReportMaker="false" truncateTo="4000"/>
         </dynamicAttributes>
    </question>


    <!--++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!-- BLAST Similarity -->
    <!--++++++++++++++++++++++++++++++++++++++++++++++++-->


    <question name="OrfsBySimilarity"
         displayName="ORFs by BLAST Similarity"
         queryRef="OrfIds.OrfsBySimilarity"
         recordClassRef="OrfRecordClasses.OrfRecordClass">

      <attributesList
         summary="Header,TabularRow,Alignment,Footer"
      />

        <summary>
           Find ORFs that have BLAST similarity to your input sequence.
        </summary>
        <description includeProjects="PlasmoDB,ToxoDB">
           <![CDATA[
             Find ORFs that have BLAST similarity to your input query sequence.
            <p>The search uses <a href="http://www.ncbi.nlm.nih.gov/BLAST/">NCBI BLAST</a>.
          ]]>
        </description>
        <description includeProjects="CryptoDB,ApiDB">
           <![CDATA[
             Find ORFs that have BLAST similarity to your input query sequence.
            <p>The search uses <a href="http://blast.wustl.edu/" target="_blank">WU BLAST</a>.
          ]]>
        </description>


         <dynamicAttributes>
             <columnAttribute name="TabularRow" displayName="Blast summary"
                              inReportMaker="false"/>
             <columnAttribute name="Alignment" displayName="Blast alignment"
                              inReportMaker="false"/>
             <columnAttribute name="Header" displayName="Blast header"
                              inReportMaker="false"/>
             <columnAttribute name="Footer" displayName="Blast footer"
                              inReportMaker="false"/>
         </dynamicAttributes>
    </question>


    
  </questionSet>



</wdkModel>
