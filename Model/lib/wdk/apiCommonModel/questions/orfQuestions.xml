<wdkModel>

  <questionSet name="OrfQuestions"
               displayName="Search ORFs">

    <!--++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!-- Location  -->
    <!--++++++++++++++++++++++++++++++++++++++++++++++++-->

    <question name="OrfsByLocation"
              category="Genomic Position"
              displayName="Chromosomal Location"
              queryRef="OrfIds.OrfsByLocation"
              recordClassRef="OrfRecordClasses.OrfRecordClass">

      <attributesList 
             summary="formatted_organism,orf_location_text,length"
             sorting="formatted_organism asc,orf_location_text asc"
      />

      <summary>
          Find Orfs that are located in a specified genomic region.
      </summary>

  <description includeProjects="CryptoDB">
           <![CDATA[
          Find ORFs within a given genomic region.<br>
          Select a <i>C. parvum</i> chromosome from the pull-down menu or
          enter the name of a contig for either <i>C. parvum</i> or <i>C. hominis</i>(e.g."AAEL01000057").
          If you enter both, your result will include the union.
          The Start and End locations correspond to the coordinates of the ORF(s) on the chromosome.
          ]]>
        </description>
        <description includeProjects="PlasmoDB">
          <![CDATA[
          Find ORFs that are located in a specified genomic region.<br><br>
          Either select a <i>P. falciparum</i> genomic sequence from the
          pull-down menu <i>or</i> enter a genomic sequence ID from any
          <i>Plasmodium</i> species (if you supply both,  your result will include the union).
          The Start and End locations correspond to the coordinates of the ORF(s) on the chromosome.
          ]]>
        </description>
        <description includeProjects="ApiDB">
          <![CDATA[
          Find ORFs within a given genomic region.<br>
          Either select an organism and a genomic sequence from the
          pull-down menu or enter a genomic sequence ID from any Crypto,
          Plasmo or Toxo species (e.g. "AAEL01000057", "MAL4", "Ia").
          If you enter both, your result will include the union.
          The Start and End locations correspond to the coordinates of
          the ORF(s) on the chromosome.
          ]]>
        </description>
        <description includeProjects="TrichDB">
          <![CDATA[
          Find ORFs within a given genomic region.<br>
          Enter a genomic sequence ID for any <i>T. vaginalis</I> contig.
          The Start and End locations correspond to the coordinates of
          the ORF(s) on the chromosome.
          ]]>
        </description>
        <description includeProjects="GiardiaDB">
          <![CDATA[
          Find ORFs within a given genomic region.<br>
          Enter a genomic sequence ID for any <i>G. lamblia</I> contig.
          The Start and End locations correspond to the coordinates of
          the ORF(s) on the sequence.
          ]]>
        </description>
        <description includeProjects="ToxoDB">
              <![CDATA[
          Find ORFs that are located in a specified genomic region.<br><br>
          Either select a <i>T. gondii</i> chromosome from the pull-down menu
          <b>or</b> enter a sequence ID of a chromosome (e.g. "VIIa") or a
          scaffold (e.g. "TGG_994746"). <br>
          If you enter both, your result will include the union.
          The Start and End locations correspond to the coordinates of the ORF(s) on the chromosome.
          ]]>
        </description>


       <propertyList name="specificAttribution">
       </propertyList>
    </question>


    <!--++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!-- Id -->
    <!--++++++++++++++++++++++++++++++++++++++++++++++++-->

    <question name="OrfByOrfId" excludeProjects="ApiDB" 
              displayName="Orfs by ID"
              queryRef="OrfIds.OrfByOrfId" 
              recordClassRef="OrfRecordClasses.OrfRecordClass"
              noSummaryOnSingleRecord="true">

             <attributesList 
               summary="formatted_organism,orf_location_text,length"
               sorting="formatted_organism asc, orf_location_text asc"
             />
             <summary>
             Find ORFs by ID.
             </summary>
             <description includeProjects="CryptoDB">
             <![CDATA[
             Find open reading frames (ORFs) by ID. The ORF ID and sequences may change from release to release if the genomic sequence changes.
             The ORF naming system is designed to:
             <ul>
             <li>Specify the name of the DNA sequence producing the ORF, e.g. AAEL01000259</li>
             <li>The Frame (1-6) the ORF was found in, e.g. 5</li>
             <li>The span, in nucleotides, encoding the ORF, e.g. 3339-3085</li>
             <li>Putting it all together: AAEL01000259-5-3339-3085</li>
             </ul>
             ]]>
             </description>
             <description includeProjects="GiardiaDB">
             <![CDATA[
             Find open reading frames (ORFs) by ID. The ORF ID and sequences may change from release to release if the genomic sequence changes.
             The ORF naming system is designed to:
             <ul>
             <li>Specify the name of the DNA sequence producing the ORF, e.g. ctg02_243</li>
             <li>The Frame (1-6) the ORF was found in, e.g. 6</li>
             <li>The span, in nucleotides, encoding the ORF, e.g. 1018-419</li>
             <li>Putting it all together: ctg02_243-6-1018-419</li>
             </ul>
             ]]>
             </description>
             <description includeProjects="PlasmoDB">
             <![CDATA[
             Find open reading frames (ORFs) by ID. The ORF ID and sequences may change from release to release if the genomic sequence changes.
             The ORF naming system is designed to:
             <ul>
             <li>Specify the name of the DNA sequence producing the ORF, e.g. MAL1</li>
             <li>The Frame (1-6) the ORF was found in, e.g. 1</li>
             <li>The span, in nucleotides, encoding the ORF, e.g. 10639-11520</li>
             <li>Putting it all together: MAL1-1-10639-11520</li>
             </ul>
             ]]>
             </description>
             <description includeProjects="ToxoDB">
             <![CDATA[
             Find open reading frames (ORFs) by ID. The ORF ID and sequences may change from release to release if the genomic sequence changes.
             The ORF naming system is designed to:
             <ul>
             <li>Specify the name of the DNA sequence producing the ORF, e.g. Ia</li>
             <li>The Frame (1-6) the ORF was found in, e.g. 1</li>
             <li>The span, in nucleotides, encoding the ORF, e.g. 1000180-1000404</li>
             <li>Putting it all together: Ia-1-1000180-1000404</li>
             </ul>
             ]]>
             </description>
             <description includeProjects="TrichDB">
             <![CDATA[
             Find open reading frames (ORFs) by ID. The ORF ID and sequences may change from release to release if the genomic sequence changes.
             The ORF naming system is designed to:
             <ul>
             <li>Specify the name of the DNA sequence producing the ORF, e.g. DS113375</li>
             <li>The Frame (1-6) the ORF was found in, e.g. 1</li>
             <li>The span, in nucleotides, encoding the ORF, e.g. 114214-114468</li>
             <li>Putting it all together: DS113375-1-114214-114468</li>
             </ul>
             ]]>
             </description>
       <propertyList name="specificAttribution">
       </propertyList>
    </question>

    <question name="OrfByOrfId" includeProjects="ApiDB" 
              displayName="Orfs by ID"
              queryRef="OrfIds.OrfByOrfId" 
              recordClassRef="OrfRecordClasses.OrfRecordClass"
              noSummaryOnSingleRecord="false">

             <attributesList 
               summary="formatted_organism,orf_location_text,length"
               sorting="formatted_organism asc, orf_location_text asc"
             />
             <summary>
             Find ORFs by ID.
             </summary>
             <description >
             <![CDATA[
             Find open reading frames (ORFs) by ID. The ORF ID and sequences may change from release to release if the genomic sequence changes.
             The ORF naming system is designed to:
             <ul>
             <li>Specify the name of the DNA sequence producing the ORF, e.g. AAEL01000259</li>
             <li>The Frame (1-6) the ORF was found in, e.g. 5</li>
             <li>The span, in nucleotides, encoding the ORF, e.g. 3339-3085</li>
             <li>Putting it all together: AAEL01000259-5-3339-3085</li>
             </ul>
             ]]>
             </description>
       <propertyList name="specificAttribution">
       </propertyList>
    </question>


    <!--++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!-- Mass Spec -->
    <!--++++++++++++++++++++++++++++++++++++++++++++++++-->

    <question name="OrfsByMassSpec" includeProjects="CryptoDB,ToxoDB,ApiDB" 
              category="Other Attributes"
              displayName="Mass Spec. Evidence"
              queryRef="OrfIds.OrfsByMassSpec" 
              recordClassRef="OrfRecordClasses.OrfRecordClass">

          <attributesList 
              summary="formatted_organism,orf_location_text,sum_sequence_count,sum_spectrum_count"
              sorting="formatted_organism asc,sum_sequence_count desc,sum_spectrum_count desc"
          />

              <summary>
             Find open reading frames that have evidence of expression based on peptides identified in sporozoites by MS/MS analysis.
              </summary>

              <description includeProjects="CryptoDB">
              <![CDATA[
             Find <i>Cryptosporidium</i> open reading frames that have evidence of expression 
             based on peptides identified by MS/MS analysis in an sporozoite excystation mixture. Some contaiminating oocyst proteins will also be in the mixture.<p>
            See the related <a href="showQuestion.do?questionFullName=GeneQuestions.GenesByMassSpec"><b>Genes with Mass Spec. Evidence</b></a> query to find gene models which have mapped MS/MS peptides.  NOTE: This query only returns ORFs that contain peptides that could not be mapped onto an annotated gene model overlapping with the ORF.
            <p>
             <sup>&#182;</sup>
   <%-- description by J. Wastling --%>
<i> S.J. Sanderson, D. Xia, H. Prieto, J. Yates, M. Heiges. J. Kissinger & J.M. Wastling (submitted). <b>Contact: Jonathan Wastling for details (<a href="mailto:j.wastling@liv.ac.uk">j.wastling@liv.ac.uk</a>)</b></i>.
<br>
Mass spectrometry data were obtained from two-dimensional gel 
electrophoretic protein separations, one-dimensional gel LC-MS/MS and 
MudPIT analysis of a sporozoite/oocyst excystation mixture of 
<i>Cryptosporidium parvum</i>.  A total of approximately 3,500 protein 
hits were obtained resulting in 1,252 non-redundant protein identifications.  
In addition a further 100 hits were obtained to sequences which matched a 
predicted open reading frame, but for which no gene model currently exists.  
In total these protein identifications represent nearly one third of the 
entire predicted proteome of <i>C. parvum</i>, although it is unlikely 
that the entire proteome from all life-stages will be expressed at any 
one time.
             ]]>
             </description>

 <description includeProjects="ApiDB">
              <![CDATA[
             Find <i>Cryptosporidium</i> and <i>Toxoplasma</i> open reading frames that have evidence of expression 
             based on peptides identified by MS/MS analysis in an sporozoite excystation mixture. Some contaiminating oocyst proteins will also be in the mixture.<p>
            See the related <a href="showQuestion.do?questionFullName=GeneQuestions.GenesByMassSpec"><b>Genes with Mass Spec. Evidence</b></a> query to find gene models which have mapped MS/MS peptides.  NOTE: This query only returns ORFs that contain peptides that could not be mapped onto an annotated gene model overlapping with the ORF.
            <p>
             <sup>&#182;</sup>
  
<i> S.J. Sanderson, D. Xia, H. Prieto, J. Yates, M. Heiges. J. Kissinger & J.M. Wastling (submitted). <b>Contact: Jonathan Wastling for details (<a href="mailto:j.wastling@liv.ac.uk">j.wastling@liv.ac.uk</a>)</b></i>.
<br>
Mass spectrometry data were obtained from two-dimensional gel 
electrophoretic protein separations, one-dimensional gel LC-MS/MS and 
MudPIT analysis of a sporozoite/oocyst excystation mixture of 
<i>Cryptosporidium parvum</i>.  A total of approximately 3,500 protein 
hits were obtained resulting in 1,252 non-redundant protein identifications.  
In addition a further 100 hits were obtained to sequences which matched a 
predicted open reading frame, but for which no gene model currently exists.  
In total these protein identifications represent nearly one third of the 
entire predicted proteome of <i>C. parvum</i>, although it is unlikely 
that the entire proteome from all life-stages will be expressed at any 
one time.

 <p>
             <sup>1</sup> <i>Proteomics data from JM Wastling, SJ Sanderson, D Xia, J Yates, H Prieto.</i> Contact: Jonathan Wastling for details (j.wastling@liv.ac.uk)<br>
             Mass spectrometry data were obtained from one-dimensional gel LC-MS/MS and MudPIT analysis of Toxoplasma gondii tachyzoites. 6,546 protein hits were obtained resulting in 2217 non-redundant protein identifications. A further 318 hits were obtained to sequences which matched 226 predicted open reading frames for which no gene model currently exists.  Additionally, 163 gene predictions were hit that did not have an overlapping gene model to which at least 50% of the peptides could be mapped.  In total these protein identifications from one stage represent nearly one third of the entire predicted proteome of T. gondii.
             <br>
             <sup>*</sup><i>Bradley PJ, Ward C, Cheng SJ, Alexander DL, Coller S, Coombs GH, Dunn JD, Ferguson DJ, Sanderson SJ, Wastling JM,Boothroyd JC. 
             Proteomic analysis of rhoptry organelles reveals many novel constituents for host-parasite interactions in Toxoplasma gondii. 
             J Biol Chem. 2005 Oct 7;280(<b>40</b>):34245-58</i>
             <p>
             <sup>2</sup><i>Hu K, Johnson J, Florens L, Fraunholz M, Suravajjala S, 
	     DiLullo C, Yates JR, Roos DS, Murray JM. (2006) 
	     Cytoskeletal Components of an Invasion Machine - The Apical Complex of Toxoplasma gondii. 
	     PLoS Pathog <b>2</b>:121-138.</i><br>
             "1,887 protein hits were obtained resulting in 1,166 non-redundant protein identifications. A further 498 hits were obtained to sequences which matched 446 predicted open reading frames for which no gene model currently exists.  "
             <p><p>
             Taken together, these two datasets result in 8,433 protein hits to 2,436 non-redundant Toxoplasma proteins and 816 hits to 634 non-redundant ORFs that contain peptides that couldn't be mapped to annotated proteins. 
             With the additional evidence from the predicted gene models, nearly 40% of the predicted proteome from T. gondii is represented.  The data provide evidence that often corroborates the annotated gene models and in some instances the peptides mapping to ORFs and predicted gene models provide evidence for alternatives to the current annotations.


             ]]>
             </description>


              <description includeProjects="ToxoDB">
              <![CDATA[
             <p>
             Find <i>Toxoplasma</i> ORFs that have evidence of protein expression based on Mass Spec analyses.
             <p>See the related <a href="showQuestion.do?questionFullName=GeneQuestions.GenesByMassSpec"><b>Genes with Mass Spec. Evidence</b></a> query to find gene models which have mapped MS/MS peptides.  NOTE: This query only returns ORFs that contain peptides that could not be mapped onto an annotated gene model overlapping with the ORF.
             <p>
             <sup>1</sup> <i>Proteomics data from JM Wastling, SJ Sanderson, D Xia, J Yates, H Prieto.</i> Contact: Jonathan Wastling for details (j.wastling@liv.ac.uk)<br>
             Mass spectrometry data were obtained from one-dimensional gel LC-MS/MS and MudPIT analysis of Toxoplasma gondii tachyzoites. 6,546 protein hits were obtained resulting in 2217 non-redundant protein identifications. A further 318 hits were obtained to sequences which matched 226 predicted open reading frames for which no gene model currently exists.  Additionally, 163 gene predictions were hit that did not have an overlapping gene model to which at least 50% of the peptides could be mapped.  In total these protein identifications from one stage represent nearly one third of the entire predicted proteome of T. gondii.
             <br>
             <sup>*</sup><i>Bradley PJ, Ward C, Cheng SJ, Alexander DL, Coller S, Coombs GH, Dunn JD, Ferguson DJ, Sanderson SJ, Wastling JM,Boothroyd JC. 
             Proteomic analysis of rhoptry organelles reveals many novel constituents for host-parasite interactions in Toxoplasma gondii. 
             J Biol Chem. 2005 Oct 7;280(<b>40</b>):34245-58</i>
             <p>
             <sup>2</sup><i>Hu K, Johnson J, Florens L, Fraunholz M, Suravajjala S, 
	     DiLullo C, Yates JR, Roos DS, Murray JM. (2006) 
	     Cytoskeletal Components of an Invasion Machine - The Apical Complex of Toxoplasma gondii. 
	     PLoS Pathog <b>2</b>:121-138.</i><br>
             1,887 protein hits were obtained resulting in 1,166 non-redundant protein identifications. A further 498 hits were obtained to sequences which matched 446 predicted open reading frames for which no gene model currently exists.  
             <p><p>
             Taken together, these two datasets result in 8,433 protein hits to 2,436 non-redundant Toxoplasma proteins and 816 hits to 634 non-redundant ORFs that contain peptides that couldn't be mapped to annotated proteins. 
             With the additional evidence from the predicted gene models, nearly 40% of the predicted proteome from T. gondii is represented.  The data provide evidence that often corroborates the annotated gene models and in some instances the peptides mapping to ORFs and predicted gene models provide evidence for alternatives to the current annotations.
             ]]>
             </description>

	<dynamicAttributes>
	     <columnAttribute name="sum_sequence_count" displayName="Number of Peptide Sequences" align="center"/>
	     <columnAttribute name="sum_spectrum_count" displayName="Number of Spectra" align="center"/>
	</dynamicAttributes>
       <propertyList name="specificAttribution">
           <value includeProjects="CryptoDB">Wastling1DGelLSMassSpec</value>
           <value includeProjects="CryptoDB">Wastling2DGelLSMassSpec</value>
           <value includeProjects="CryptoDB">WastlingMudPitSolMassSpec</value>
           <value includeProjects="CryptoDB">WastlingMudPitInsolMassSpec</value>
           <value includeProjects="ToxoDB">Wastling-Rhoptry</value>
           <value includeProjects="ToxoDB">Wastling1D_SDSPage</value>
           <value includeProjects="ToxoDB">Wastling-1D_SDSPage-Soluble</value>
           <value includeProjects="ToxoDB">Wastling-1D_SDSPage-Insoluble</value>
           <value includeProjects="ToxoDB">Wastling-MudPIT-Soluble</value>
           <value includeProjects="ToxoDB">Wastling-MudPIT-Insoluble</value>
           </propertyList>
    </question>


    <!--++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!-- Motif Search  -->
    <!--++++++++++++++++++++++++++++++++++++++++++++++++-->


    <question name="OrfsByMotifSearch"
         displayName="Protein Motif Search"
         category="Similarity/Pattern"
         queryRef="OrfIds.OrfsByMotifSearch"
         recordClassRef="OrfRecordClasses.OrfRecordClass">
      <attributesList
         summary="organism,Locations,MatchCount,Sequence"

      />
          <summary>
             Find orfs with a motif pattern that you specify, e.g.: two cysteines followed by one or more hydrophobic amino acids, followed by arginine, then lysine.
         </summary>

         <description>
           <![CDATA[

         Find genes whose protein product contains a motif pattern that you specify.<p>

           Specify the pattern with a (Perl style) "regular expression".
           (Regular expressions are more powerful than PROSITE patterns.) For
           a description of how to create regular expressions, please see 
           the  <a href="regexp.jsp">Regular Expression
           Tutorial</a>.
            <br><br>
             The following codes can be used to represent classes of amino acids.
        <table border columns=3>
                   <TR>
                      <TD><B>AA property</B>
                      </TD>
                      <TD><B>Amino acids</B>
                      </TD>
                      <TD><B>Code</B>
                      </TD>
                   </TR>

                   <TR>
                      <TD>
                      <B>Acidic</B>
                      </TD>
                      <TD><B>DE</B>
                      </TD>
                      <TD><B>0</B>
                      </TD>
                   </TR>
                   <TR>
                      <TD><B>Alcohol</B>
                      </TD>
                      <TD><B>ST</B>
                      </TD>
                      <TD><B>1</B>
                      </TD>
                   </TR>
                   <TR>
                      <TD><B>Aliphatic</B>
                      </TD>
                      <TD><B>ILV</B>
                      </TD>
                      <TD><B>2</B>
                      </TD>
                   </TR>
                   <TR>
                      <TD><B>Aromatic</B>
                      </TD>
                      <TD><B>FHWY</B>
                      </TD>
                      <TD><B>3</B>
                      </TD>
                   </TR>
                   <TR>
                      <TD><B>Basic</B>
                      </TD>
                      <TD><B>KRH</B>
                      </TD>
                      <TD><B>4</B>
                      </TD>
                   </TR>
                   <TR>
                      <TD><B>Charged</B>
                      </TD>
                      <TD><B>DEHKR</B>
                      </TD>
                      <TD><B>5</B>
                      </TD>
                   </TR>
                   <TR>
                      <TD><B>Hydrophobic</B>
                      </TD>
                      <TD><B>AVILMFYW</B>
                      </TD>
                      <TD><B>6</B>
                      </TD>
                   </TR>
                   <TR>
                      <TD><B>Hydrophilic</B>
                      </TD>
                      <TD><B>KRHDENQ</B>
                      </TD>
                      <TD><B>7</B>
                      </TD>
                   </TR>
                   <TR>
                      <TD><B>Polar</B>
                      </TD>
                      <TD><B>CDEHKNQRST</B>
                      </TD>
                      <TD><B>8</B>
                      </TD>
                   </TR>
                   <TR>
                      <TD><B>Small</B>
                      </TD>
                      <TD><B>ACDGNPSTV</B>
                      </TD>
                      <TD><B>9</B>
                      </TD>
                   </TR>
                   <TR>
                      <TD><B>Tiny</B>
                      </TD>
                      <TD><B>AGS</B>
                      </TD>
                      <TD><B>B</B>
                      </TD>
                   </TR>
                   <TR>
                      <TD><B>Turnlike</B>
                      </TD>
                      <TD><B>ACDEGHKNQRST</B>
                      </TD>
                      <TD><B>Z</B>
                      </TD>
                   </TR>
                   <TR>
                      <TD><B>Any</B>
                      </TD>
                      <TD><b>ACDEFGHIKLM<br>
                             NPQRSTVWY</b>
                      </TD>
                      <TD><B>.</B>
                      </TD>
                   </TR>
                   </table>

          ]]>
         </description>
         <dynamicAttributes>
           <columnAttribute name="Locations" displayName="Match Locations" inReportMaker="false"/>
           <columnAttribute name="MatchCount" displayName="Match Count"  inReportMaker="false"/>
           <columnAttribute name="Sequence" inReportMaker="false" truncateTo="4000"/>
         </dynamicAttributes>
       <propertyList name="specificAttribution">
       </propertyList>
    </question>


    <!--++++++++++++++++++++++++++++++++++++++++++++++++-->
    <!-- BLAST Similarity -->
    <!--++++++++++++++++++++++++++++++++++++++++++++++++-->


    <question name="OrfsBySimilarity"
         displayName="BLAST"
         queryRef="OrfIds.OrfsBySimilarity"
         recordClassRef="OrfRecordClasses.OrfRecordClass"
         fullAnswer="true">

      <attributesList
         summary="Header,TabularRow,Alignment,Footer"
      />

        <summary>
           Find ORFs that have BLAST similarity to your input sequence.
        </summary>

        <description>
           <![CDATA[
             Find ORFs that have BLAST similarity to your input query sequence.
            <p>The search uses <a href="http://blast.wustl.edu/" target="_blank">WU BLAST</a>.
          ]]>
        </description>


         <dynamicAttributes>
             <columnAttribute name="TabularRow" displayName="Blast summary"
                              inReportMaker="false"/>
             <columnAttribute name="Alignment" displayName="Blast alignment"
                              inReportMaker="false"/>
             <columnAttribute name="Header" displayName="Blast header"
                              inReportMaker="false"/>
             <columnAttribute name="Footer" displayName="Blast footer"
                              inReportMaker="false"/>
         </dynamicAttributes>
       <propertyList name="specificAttribution">
       </propertyList>
    </question>


    
  </questionSet>



</wdkModel>
