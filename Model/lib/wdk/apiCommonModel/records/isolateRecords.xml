<wdkModel>
    <recordClassSet name="IsolateRecordClasses" includeProjects="CryptoDB,PlasmoDB, ApiDB">

      <recordClass name="IsolateRecordClass" type="Isolate" includeProjects="CryptoDB,PlasmoDB,ApiDB">

    
      <testParamValues includeProjects="PlasmoDB">
         <paramValue name="source_id">BC.458098</paramValue>
         <paramValue name="project_id">PlasmoDB</paramValue>
      </testParamValues>

      <testParamValues includeProjects="CryptoDB">
         <paramValue name="source_id">AY168847</paramValue>
         <paramValue name="project_id">CryptoDB</paramValue>
      </testParamValues>

      <testParamValues includeProjects="ToxoDB">
         <paramValue name="source_id">none</paramValue>
         <paramValue name="project_id">ToxoDB</paramValue>
      </testParamValues>

            <!-- primary key definition -->
            <primaryKeyAttribute name="primary_key"
                                 displayName="Gene">
                <columnRef>source_id</columnRef>
                <columnRef>project_id</columnRef>
                <text>
                    <![CDATA[
                    $$project_id$$:$$source_id$$
                    ]]>
                </text>                
            </primaryKeyAttribute>


      <!-- =============================================================== -->
      <!--   Reporters -->
      <!-- =============================================================== -->

      <reporter name="tabular" displayName="Summary - TAB Delimited"
                implementation="org.gusdb.wdk.model.report.TabularReporter" />

      <reporter name="fullRecord" displayName="Detailed" excludeProjects="ApiDB" 
                  implementation="org.gusdb.wdk.model.report.FullRecordReporter" />


      <!-- =================================================================== -->
      <!--  Attributes  ++++++++-->
      <!-- =================================================================== -->

      <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
      <!-- sequence attributes -->  
      <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

      <attributeQueryRef ref="IsolateAttributes.Sequence" includeProjects="CryptoDB,PlasmoDB,ApiDB"> 
         <columnAttribute name="pcr_primers" displayName="PCR primer" internal="true"/>
         <columnAttribute name="country" displayName="Country" internal="false"/>

         <columnAttribute name="organism" displayName="Organism" internal="false" includeProjects="CryptoDB,ApiDB"/>
         <columnAttribute name="organism" displayName="Organism" internal="true" includeProjects="PlasmoDB"/>

         <columnAttribute name="strain" displayName="Strain" internal="false"/> 

         <columnAttribute name="specific_host" displayName="Host" internal="false" includeProjects="CryptoDB,ApiDB"/>
         <columnAttribute name="specific_host" displayName="Host" internal="true" includeProjects="PlasmoDB"/>

         <columnAttribute name="isolation_source" displayName="Isolation Source" internal="false" includeProjects="CryptoDB,ApiDB"/>
         <columnAttribute name="isolation_source" displayName="Isolation Source" internal="true" includeProjects="PlasmoDB"/>

         <columnAttribute name="description" displayName="Description" internal="false"/> 

         <columnAttribute name="note" displayName="Note" internal="true"/> 

         <columnAttribute name="product" displayName="Isolate Product" internal="false" includeProjects="CryptoDB,ApiDB"/>
         <columnAttribute name="product" displayName="Isolate Product" internal="true" includeProjects="PlasmoDB"/>

         <columnAttribute name="is_reference" displayName="Is Reference" internal="false" includeProjects="CryptoDB,ApiDB"/>
         <columnAttribute name="is_reference" displayName="Is Reference" internal="true" includeProjects="PlasmoDB"/>

         <columnAttribute name="data_type" displayName="Isolate Type" internal="false"/> 
         <columnAttribute name="collected_by" displayName="Submitter" internal="false"/>
      </attributeQueryRef>

      <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
      <!-- Protein Sequence attributes -->  
      <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

      <attributeQueryRef ref="IsolateAttributes.ProteinSequence" includeProjects="CryptoDB,ApiDB">
         <columnAttribute name="protein_sequence" displayName="Protein Sequence" internal="true" includeProjects="CryptoDB"/>
         <columnAttribute name="gene_description" displayName="Gene Description" internal="true" includeProjects="CryptoDB,ApiDB"/>
      </attributeQueryRef>

      <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
      <!-- Gene Overlap attributes -->  
      <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

<!--

      <attributeQueryRef ref="IsolateAttributes.GeneOverlap" includeProjects="CryptoDB,ApiDB">
         <columnAttribute name="gene" displayName="Gene" internal="false" includeProjects="CryptoDB,ApiDB"/>
         <columnAttribute name="gene_product" displayName="Gene Product" internal="false" includeProjects="CryptoDB,ApiDB"/>
      </attributeQueryRef>

-->
      <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
      <!-- Reference attributes -->  
      <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

      <attributeQueryRef ref="IsolateAttributes.Reference" includeProjects="CryptoDB,ApiDB">
         <columnAttribute name="title" displayName="Title" internal="true" inReportMaker="false" includeProjects="CryptoDB,ApiDB"/>
         <columnAttribute name="author" displayName="Author" internal="true" inReportMaker="false" includeProjects="CryptoDB,ApiDB"/>
         <columnAttribute name="year" displayName="Year" internal="true"  inReportMaker="false" includeProjects="CryptoDB,ApiDB"/>
         <columnAttribute name="journal_or_book_name" displayName="Journal Name" inReportMaker="false" internal="true" includeProjects="CryptoDB,ApiDB"/>
         <columnAttribute name="journal_vol" displayName="Volume" internal="true" inReportMaker="false" includeProjects="CryptoDB,ApiDB"/>
         <columnAttribute name="journal_page" displayName="Page" internal="true" inReportMaker="false" includeProjects="CryptoDB,ApiDB"/>
      </attributeQueryRef>

      <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
      <!-- Reference attributes -->  
      <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

      <attributeQueryRef ref="IsolateAttributes.UniqueReference" includeProjects="CryptoDB,ApiDB">
         <columnAttribute name="unique_title" displayName="Study Name" internal="false" inReportMaker="false" includeProjects="CryptoDB,ApiDB"/>
         <columnAttribute name="unique_author" displayName="Author" internal="true" inReportMaker="false" includeProjects="CryptoDB,ApiDB"/>
         <columnAttribute name="unique_year" displayName="Year" internal="true"  inReportMaker="false" includeProjects="CryptoDB,ApiDB"/>
     </attributeQueryRef>

     <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
     <!-- Isolates Publication table -->
     <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

     <table name="Reference" includeProjects="CryptoDB,ApiDB"
            displayName="Isolates Publication"
            queryRef="IsolateTables.Reference">
        <columnAttribute displayName="Title" name="title"/>
        <columnAttribute displayName="Author" name="author"/>
        <columnAttribute displayName="Journal" name="journal_or_book_name"/>
     </table>

     <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
     <!-- Other Isolates in this Study -->
     <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

     <table name="IsoStudy" includeProjects="CryptoDB,ApiDB"
            displayName="All the isolate in the study"
            queryRef="IsolateTables.IsoStudy">
        <columnAttribute displayName="Isolates" name="source_id" internal="true"/>
        <linkAttribute displayName="Isolate ID" name="isolate_study_link" inReportMaker="false" internal="false" >
           <displayText>
            <![CDATA[ $$source_id$$ ]]>
              </displayText>
              <url>
              <![CDATA[                       
              showRecord.do?name=IsolateRecordClasses.IsolateRecordClass&primary_key=$$source_id$$&project_id=CryptoDB
              ]]>
              </url>
        </linkAttribute>
        <columnAttribute displayName="" name="checkbox"/>
        <columnAttribute displayName="Organism" name="organism"/>
        <columnAttribute displayName="Strain" name="strain"/>
        <columnAttribute displayName="Nucleotide Squences" name="definition"/>

     </table>


     <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
     <!-- Gene Overlap -->
     <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

     <table name="GeneOverlap" includeProjects="PlasmoDB,CryptoDB,ApiDB"
            displayName="Overlapping Genes based on blast similarity"
            queryRef="IsolateTables.GeneOverlap">
        <columnAttribute name="source_id" internal="true"/>
        <columnAttribute  name="project_id" internal="true"/>
        <columnAttribute  name="gene" internal="true"/>
        <columnAttribute  displayName="Gene Product" name="gene_project" internal="false"/>
        <columnAttribute  name="pvalue_mant" internal="true"/>
        <columnAttribute  name="pvalue_exp" internal="true"/>

        <columnAttribute  name="sequence_source_id" internal="true"/>

        <linkAttribute displayName="Gene" name="gene_link" inReportMaker="false" internal="false" >
           <displayText>
            <![CDATA[ $$gene$$  ]]>
           </displayText>
           <url>
            <![CDATA[                       
              showRecord.do?name=GeneRecordClasses.GeneRecordClass&project_id=@PROJECT_ID@&source_id=$$gene$$
              ]]>
            </url>
        </linkAttribute>

        <linkAttribute displayName="Gene" name="sequence_link" inReportMaker="false" internal="false" >
           <displayText>
            <![CDATA[ $$gene$$  ]]>
           </displayText>
           <url>
            <![CDATA[                       
              showRecord.do?name=SequenceRecordClasses.SequenceRecordClass&project_id=@PROJECT_ID@&source_id=$$sequence_source_id$$
              ]]>
            </url>
        </linkAttribute>
        <columnAttribute  displayName="Start" name="start_min" internal="false"/>
        <columnAttribute  displayName="End" name="end_max" internal="false"/>

        <textAttribute inReportMaker="false" name="pvalue" displayName="P Value">
             <text>
              <![CDATA[
                 $$pvalue_mant$$ * 10<sup>^$$pvlaue_exp$$</sup>
                    ]]>
                  </text>
            </textAttribute>

     </table>

     <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
     <!-- Isolates Barcode SNP table -->
     <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

     <table name="SNP" includeProjects="ApiDB,PlasmoDB"
            displayName="Isolates SNP Features"
            queryRef="IsolateTables.SNP">
        <columnAttribute displayName="Allele" name="allele" internal="true"/>
        <columnAttribute displayName="Allele" name="colored_allele"/>
        <columnAttribute displayName="Major Allele" name="major_allele"/>
        <columnAttribute displayName="Minor Allele" name="minor_allele"/>
        <columnAttribute displayName="Chromosome" name="chromosome"/>
        <columnAttribute displayName="Position" name="start_min"/>
        <columnAttribute name="snp_id" internal="true"/>
        <linkAttribute displayName="SNP ID" name="snp_id_link"
                       inReportMaker="false" internal="false" >
                 <displayText>
                    <![CDATA[ $$snp_id$$ ]]>
                 </displayText>
            <url> 
             <![CDATA[showRecord.do?name=SnpRecordClasses.SnpRecordClass&primary_key=$$snp_id$$&project_id=PlasmoDB]]> 
             </url>
        </linkAttribute>
     </table>

     <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
     <!-- overview -->
     <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
     <textAttribute name="overview" displayName="Overview"
          internal="true" inReportMaker="false" includeProjects="CryptoDB,ApiDB">
          <text>
          <![CDATA[
           <table>
             <tr>
              <td width=18%>Isolate ID:</td>
              <td>$$source_id$$ <a href="http://www.ncbi.nlm.nih.gov/entrez/viewer.fcgi?db=nuccore&id=$$source_id$$" target=_blank><font size="-1">click here to Genbank</font></a></td>
             </tr>
             <tr>
              <td>Description:</td>
              <td>$$description$$</td>
             </tr>
             <tr>
              <td>Organism:</td>
              <td><i>$$organism$$</i></td>
             </tr>
             <tr>
              <td>Strain:</td>
              <td>$$strain$$</td>
             </tr>
             <tr>
              <td>Host:</td>
              <td>$$specific_host$$</td>
             </tr>
             <tr>
              <td>Product:</td>
              <td>$$product$$</td>
             </tr>
             <tr>
              <td>Note:</td>
              <td>$$note$$</td>
             </tr>
             <tr>
              <td>PCR Primer:</td>
              <td>$$pcr_primers$$</td>
             </tr>
             <tr>
              <td>Isolation Source:</td>
              <td>$$isolation_source$$</td>
             </tr>
           </table>
          ]]>
          </text>
     </textAttribute>

     </recordClass>

  </recordClassSet>
</wdkModel>

