<wdkModel>

    <recordClassSet name="AssemblyRecordClasses" includeProjects="CryptoDB,ToxoDB">

        <!-- AssemblyRecordClasses.AssemblyRecordClass -->
        <recordClass idPrefix="" 
          name="AssemblyRecordClass" type="Assembly">

          <projectParamRef ref="recordParams.Project"/>

          <!-- =============================================================== -->
          <!--   Reporters -->  
          <!-- =============================================================== -->

          <reporter name="tabular" displayName="Summary - TAB Delimited"
                    implementation="org.gusdb.wdk.model.report.TabularReporter"/>
          <reporter name="fullRecord" displayName="Detailed"
                    implementation="org.gusdb.wdk.model.report.FullRecordReporter" />


      <!-- =================================================================== -->
      <!--  Text Attributes  ++++++++-->
      <!-- =================================================================== -->
       <attributeQueryRef ref="AssemblyAttributes.Bfmv">
        <columnAttribute name="context_start" internal="true" inReportMaker="false"/>
        <columnAttribute name="context_end" internal="true" inReportMaker="false"/>
        <columnAttribute name="project_id" internal="true" inReportMaker="false"/>
        <columnAttribute name="source_id" internal="true" inReportMaker="false"/>
        <columnAttribute name="target_source_id" internal="true" inReportMaker="false"/>
       </attributeQueryRef>

        <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
        <!-- DNA Context -->  
        <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
        <textAttribute name="dnaContext" includeProjects="CryptoDB,ToxoDB"
                       displayName="Features"
                       inReportMaker="false">
           <text>
                <![CDATA[
                @CGI_URL@/gbrowse_img/toxodb/?name=$$target_source_id$$%3A$$context_start$$-$$context_end$$;embed=1;type=DoTSAssemblies;h_feat=$$primaryKey$$@thistle;width=600;base=@CGI_URL@/gbrowse
                ]]>
           </text>
        </textAttribute>


     <!-- =================================================================== -->
     <!-- Tables ++++++++-->
     <!-- =================================================================== -->

        <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
        <!-- AlignmentInfo -->  
        <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
        <table name="AlignmentInfo"
               displayName="Alignments to genomic sequence"
               queryRef="AssemblyTables.AlignmentInfo">
            <columnAttribute name="id"            internal="true" />
            <columnAttribute name="organism" />
            <columnAttribute name="sequence_id"   internal="true" />
            <columnAttribute name="target_start"  internal="true" />
            <columnAttribute name="target_end"    internal="true" />
            <columnAttribute name="context_start" internal="true" />
            <columnAttribute name="context_end"   internal="true" />

            <columnAttribute displayName="Length" name="length"   internal="false" />
            <columnAttribute displayName="Number of ESTs" name="count" />
            <linkAttribute displayName="Genomic Sequence" name="alignedcontig" visible="$$sequence_id$$">
                 <url>
                    <![CDATA[
                    showRecord.do?name=SequenceRecordClasses.SequenceRecordClass&id=$$sequence_id$$&modgbrowse=startOverride=$$target_start$$:endOverride=$$target_end$$
                    ]]>
                 </url>
            </linkAttribute>

            <columnAttribute displayName="Percent Identity" name="percent_identity" />
            <columnAttribute displayName="Score" name="score" />
            <columnAttribute displayName="Is Consistent" name="is_consistent" />
            <columnAttribute displayName="Is Reversed" name="is_reversed" />

            <linkAttribute displayName="Alignment" name="alignmentlink" visible="view">
                 <url includeProjects="CryptoDB">
                    <![CDATA[
                    /@CGI_OR_MOD@/gbrowse/cryptodb/?name=$$sequence_id$$%3A$$context_start$$-$$context_end$$;label=Gene;label=EST;label=Cluster;h_feat=$$id$$
                    ]]>
                 </url>
                 <url includeProjects="ToxoDB">
                    <![CDATA[
                    /cgi-bin/gbrowse/toxodb/?name=$$sequence_id$$%3A$$context_start$$-$$context_end$$;label=AnnotatedGenes;label=DoTSAssemblies;h_feat=$$id$$
                    ]]>
                 </url>
            </linkAttribute>

        </table>  

        <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
        <!-- LibraryInfo -->  
        <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
        <table name="LibraryInfo" includeProjects="ToxoDB,CryptoDB"
               displayName="Libraries"
               queryRef="AssemblyTables.LibraryInfo">
            <columnAttribute displayName="Library"  name="library"/>
            <columnAttribute displayName="Number of ESTs" name="est_count"/>

        </table>  


        <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
        <!-- EstInfo -->  
        <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
        <table name="EstInfo" includeProjects="ToxoDB,CryptoDB"
               displayName="ESTs in Assembly"
               queryRef="AssemblyTables.EstInfo">
            <columnAttribute displayName="EST" name="est"  internal="true" />
            <linkAttribute displayName="EST" name="est_link" visible="$$est$$">
                <url>
                <![CDATA[showRecord.do?name=EstRecordClasses.EstRecordClass&primary_key=$$est$$]]>
                </url>
            </linkAttribute>
            <columnAttribute displayName="Start" name="start"/>
            <columnAttribute displayName="End" name="end"/>
            <columnAttribute displayName="Strand" name="assembly_strand"/>
            <columnAttribute displayName="Gapped Length" name="gapped_length"/>
            <columnAttribute displayName="Library"  name="library"/>
        </table>  


      </recordClass>
    </recordClassSet>
</wdkModel>
