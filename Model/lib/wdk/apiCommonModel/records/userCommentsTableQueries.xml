<wdkModel>
    <querySet name="UserCommentTables" queryType="table">
       <sqlQuery name="GeneComments">
            <testParamValues includeProjects="PlasmoDB">
               <paramValue name="primaryKey">PB400024.00.0</paramValue>
               <paramValue name="projectId">PlasmoDB</paramValue>
            </testParamValues>

            <testParamValues includeProjects="ToxoDB">
               <paramValue name="primaryKey">44.m00048</paramValue>
               <paramValue name="projectId">ToxoDB</paramValue>
            </testParamValues>

            <testParamValues includeProjects="CryptoDB">
               <paramValue name="primaryKey">cgd1_200</paramValue>
               <paramValue name="projectId">CryptoDB</paramValue>
            </testParamValues>

            <testParamValues includeProjects="GiardiaDB">
               <paramValue name="primaryKey">GL50803_112048</paramValue>
               <paramValue name="projectId">GiardiaDB</paramValue>
            </testParamValues>

            <testParamValues includeProjects="TrichDB">
               <paramValue name="primaryKey">TVAG_386080</paramValue>
               <paramValue name="projectId">TrichDB</paramValue>
            </testParamValues>

            <paramRef ref="recordParams.primaryKey"/>
            <paramRef ref="recordParams.projectId"/>
            <column name="comment_id"/>
            <column name="headline"/>
            <column name="content"/>
            <column name="location_string"/>
            <column name="user_name"/>
            <column name="organization"/>
            <column name="comment_date"/>
            <column name="project_name_version"/>
            <column name="review_status_id"/>
            <sql>
              <![CDATA[
              SELECT DISTINCT
                        c.comment_id,
                        NVL(c.headline, SUBSTR(c.content,0,20) || '...') AS headline,
                        c.content,
                        c.location_string,
                        (u.first_name || ' ' || u.last_name) AS user_name,
                        u.organization,
                        c.comment_date,
                        (c.project_name || ' ' || c.project_version) as project_name_version,
                        c.review_status_id
              FROM @LOGIN_SCHEMA@users@LOGIN_DBLINK@ u,
                   @COMMENT_SCHEMA@comments@COMMENT_DBLINK@ c,
                   dots.GeneFeature gf
              WHERE lower(u.email) = lower(c.email)
                AND c.comment_target_id='gene'
                AND c.stable_id = gf.source_id
                AND gf.source_id = $$primaryKey$$
                AND c.review_status_id != 'rejected'
              ORDER BY c.comment_date DESC
              ]]>
            </sql>
          </sqlQuery>

          <sqlQuery name="SequenceComments">
            <testParamValues includeProjects="PlasmoDB">
               <paramValue name="primaryKey">PB_PH0001</paramValue>
               <paramValue name="projectId">PlasmoDB</paramValue>
            </testParamValues>

            <testParamValues includeProjects="ToxoDB">
               <paramValue name="primaryKey">Ia</paramValue>
               <paramValue name="projectId">ToxoDB</paramValue>
            </testParamValues>

            <testParamValues includeProjects="CryptoDB" minRows="0">
               <paramValue name="primaryKey">dontcare</paramValue>
               <paramValue name="projectId">CryptoDB</paramValue>
            </testParamValues>

            <testParamValues includeProjects="GiardiaDB">
               <paramValue name="primaryKey">ctg02_243</paramValue>
               <paramValue name="projectId">GiardiaDB</paramValue>
            </testParamValues>

            <testParamValues includeProjects="TrichDB">
               <paramValue name="primaryKey">DS113177</paramValue>
               <paramValue name="projectId">TrichDB</paramValue>
            </testParamValues>

            <paramRef ref="recordParams.primaryKey"/>
            <paramRef ref="recordParams.projectId"/>
            <column name="comment_id"/>
            <column name="headline"/>
            <column name="content"/>
            <column name="location_string"/>
            <column name="user_name"/>
            <column name="organization"/>
            <column name="comment_date"/>
            <column name="project_name_version"/>
            <column name="review_status_id"/>
            <sql>
              <![CDATA[
              SELECT DISTINCT
              		c.comment_id,
              		NVL(c.headline, SUBSTR(c.content,0,20) || '...') AS headline,
              		c.content,
              		c.location_string,
              		(u.first_name || ' ' || u.last_name) AS user_name,
              		u.organization,
		            c.comment_date,
		            (c.project_name || ' ' || c.project_version) as project_name_version,
		            c.review_status_id
              FROM @LOGIN_SCHEMA@users@LOGIN_DBLINK@ u,
                   @COMMENT_SCHEMA@comments@COMMENT_DBLINK@ c,
                   dots.ExternalNaSequence ens
              WHERE lower(u.email) = lower(c.email)
			  		AND c.comment_target_id='genome'
                    AND c.stable_id = ens.source_id
                    AND ens.source_id = $$primaryKey$$
                    AND c.review_status_id != 'rejected'
			  ORDER BY c.comment_date DESC
               ]]>
            </sql>
          </sqlQuery>
   </querySet>
</wdkModel>
